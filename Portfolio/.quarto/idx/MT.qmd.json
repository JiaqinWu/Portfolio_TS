{"title":"Multivariate TS Models","markdown":{"yaml":{"title":"Multivariate TS Models","format":{"html":{"embed-resources":true,"code-fold":true}}},"headingText":"1. Introduction","containsRefs":false,"markdown":"\n\n```{r,message=FALSE,warning=FALSE, echo=FALSE}\nlibrary(quantmod)\nlibrary(tidyquant)\nlibrary(ggplot2)\nlibrary(plotly)\nlibrary(ggfortify)\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(forecast)\nlibrary(astsa) \nlibrary(xts)\nlibrary(tseries)\nlibrary(fpp2)\nlibrary(lubridate)\nlibrary(gridExtra)\nlibrary(fpp2)          \nlibrary(zoo)   \nlibrary(readxl)\nlibrary(vars)\nlibrary(tseries)\nlibrary(gridExtra)\nlibrary(fma)\nlibrary(TSstudio)\n```\n\n\nIn this section, we delve into the application of ARIMAX, SARIMAX, and VAR modeling techniques across a range of time series datasets pertinent to our project's scope. ARIMAX and SARIMAX models come into play when we observe a unidirectional influence from one variable onto another. Conversely, VAR models are more suited to scenarios where a set of variables exhibits mutual influences.\n\nInitiating this phase of the project involved a comprehensive literature review to identify the models previously employed to analyze COVID vaccination-related variables. The study by Yundari (2022) leverages the Vector Autoregressive (VAR) model to simultaneously analyze the impact of vaccination numbers (first dose) on new and recovered COVID-19 cases, utilizing daily data from January 13 to December 30, 2021, in West Kalimantan Province. Ye (2021) underscores the critical nature of escalating COVID-19 Daily Vaccination Numbers to curtail the pandemic, noting that achieving vaccination targets remains an uphill task. This study probes into how political partisanship might influence Daily Vaccination Numbers, drawing comparisons between Democratic and Republican counties. Asch (2024) delves into the correlation between political leanings and the reporting of vaccine adverse events (AEs), revealing that a 10% uptick in Republican votes at the state level correlates with a 5% increase in the likelihood of reporting a COVID-19 vaccine AE.\n\n**References**\n\n1. Yundari, Y., & Huda, N. M. Analysis of the Impact of Vaccination on Daily New and Recovered COVID-19 Cases Using the Vector Autoregressive (VAR) Model: A Case Study of West Kalimantan. BAREKENG: Jurnal Ilmu Matematika dan Terapan. https://ojs3.unpatti.ac.id/index.php/barekeng/article/view/5266\n\n2. Ye, X. (2021). Exploring the Relationship Between Political Partisanship and COVID-19 Vaccination Rate. https://academic.oup.com/jpubhealth/article/45/1/91/6409075\n\n3. Asch, D.A., Luo, C., & Chen, Y. (2024). Reports of COVID-19 Vaccine Adverse Events in Predominantly Republican vs Democratic States. JAMA Network Open, 7(3), e244177. https://doi.org/10.1001/jamanetworkopen.2024.4177\n\n# 2. Define Models\n\nArmed with enhanced insights into the relevant variables, this section is dedicated to defining the specific ARIMAX/SARIMAX/VAR models to be utilized for analyzing changes in Daily Vaccination Numbers. Each model is tailored to examine different facets of the interplay between COVID-19 vaccination efforts and socio-economic as well as political dynamics.\n\n## 2.1 Confirmed COVID-19 Cases as a Function of Daily Vaccination Number:\n**(ARIMAX)Confirmed COVID-19 Cases \\~ Daily Vaccination Number**\n\nThis model aims to capture the impact of Daily Vaccination Numbers on the trend of newly confirmed COVID-19 cases.\n\n```{r, message=FALSE,warning=FALSE}\n# Read the dataset\nvac_df <- read_csv(\"Datasets/us_state_vaccinations.csv\")\n\n# Select relevant columns\ncols_show <- c('date', 'location', 'daily_vaccinations_per_million')\nt <- vac_df[, cols_show]\n\n# Group by 'date' and summarize columns, ignoring NA values\nt1 <- t %>%\n  group_by(date) %>%\n  summarize(\n    daily_vaccinations_per_million = sum(daily_vaccinations_per_million, na.rm = TRUE)\n  )\n\n# Convert date column to Date format\nt1$date <- as.Date(t1$date)\n\n# Newly confirmed cases\nwide_data <- read_csv(\"Datasets/covid_confirmed_usafacts.csv\")\n\n# Define the key and value columns for pivoting\nkey_cols <- c(\"countyFIPS\", \"County Name\", \"State\", \"StateFIPS\")\nvalue_cols <- setdiff(names(wide_data), key_cols)\n\n# Pivot the data from wide to long\nlong_data <- pivot_longer(\n  wide_data,\n  cols = value_cols,\n  names_to = \"date\",\n  values_to = \"value\"\n)\n\n# Group by 'State' and 'date', and calculate the sum of Confirmed Cases\ncon_case_df <- long_data %>%\n  group_by(date) %>%\n  summarize(value_sum = sum(value, na.rm = TRUE))\n\n# Convert date column to Date format\ncon_case_df$date <- as.Date(con_case_df$date)\n\n# Merge them together\ncava_df <- merge(t1, con_case_df, by = \"date\", all = FALSE)\nhead(cava_df)\n\n# Shape of the df\ncat('The shape of this dataframe is', dim(cava_df))\n```\n\n   \n## 2.2 COVID-19 Death Cases as a Function of Daily Vaccination Number: \n**(ARIMAX)COVID-19 Death Cases \\~ Daily Vaccination Number**\n\nThrough this model, we explore how variations in Daily Vaccination Numbers influence the count of COVID-19-related fatalities.\n\n```{r, message=FALSE,warning=FALSE}\n# Read the dataset\nvac_df <- read_csv(\"Datasets/us_state_vaccinations.csv\")\n\n# Select relevant columns\ncols_show <- c('date', 'location', 'daily_vaccinations_per_million')\nt <- vac_df[, cols_show]\n\n# Group by 'date' and summarize columns, ignoring NA values\nt1 <- t %>%\n  group_by(date) %>%\n  summarize(\n    daily_vaccinations_per_million = sum(daily_vaccinations_per_million, na.rm = TRUE)\n  )\n\n# Convert date column to Date format\nt1$date <- as.Date(t1$date)\n\n\n# Death cases\nwide_data <- read_csv(\"Datasets/covid_deaths_usafacts.csv\")\n\n# Define the key and value columns for pivoting\nkey_cols <- c(\"countyFIPS\", \"County Name\", \"State\", \"StateFIPS\")\nvalue_cols <- setdiff(names(wide_data), key_cols)\n\n# Pivot the data from wide to long\nlong_data <- pivot_longer(\n  wide_data,\n  cols = value_cols,\n  names_to = \"date\",\n  values_to = \"value\"\n)\n\n# Group by 'State' and 'date', and calculate the sum of Confirmed Cases\ndead_case_df <- long_data %>%\n  group_by(date) %>%\n  summarize(value_sum = sum(value, na.rm = TRUE))\n\n# Convert date column to Date format\ndead_case_df$date <- as.Date(dead_case_df$date)\n\n# Merge them together\ndeva_df <- merge(t1, dead_case_df, by = \"date\", all = FALSE)\nhead(deva_df)\n\n# Shape of the df\ncat('The shape of this dataframe is', dim(deva_df))\n```\n\n## 2.3 Unemployment Rate as Influenced by Daily Vaccination Number and Confirmed Cases:\n**(ARIMAX)Unemployment Rate \\~ Daily Vaccination Number + Confirmed COVID-19 Cases** \n\nThis model investigates the effect of Daily Vaccination Numbers and COVID-19 case counts on the unemployment rate, providing insights into the pandemic's broader economic implications.\n\n```{r, message=FALSE,warning=FALSE}\n# Read the dataset\nvac_df <- read_csv(\"Datasets/us_state_vaccinations.csv\")\n\n# Select relevant columns\ncols_show <- c('date', 'location', 'daily_vaccinations_per_million')\nt <- vac_df[, cols_show]\n\n# Group by 'date' and summarize columns, ignoring NA values\nt1 <- t %>%\n  group_by(date) %>%\n  summarize(\n    daily_vaccinations_per_million = sum(daily_vaccinations_per_million, na.rm = TRUE)\n  )\n\n# Convert date column to Date format\nt1$date <- as.Date(t1$date)\n\n# Aggregate data to monthly level using mean for each column\nt1 <- t1 %>%\n  group_by(date = format(date, \"%Y-%m\")) %>%\n  summarize(daily_vaccinations_per_million = mean(daily_vaccinations_per_million, na.rm = TRUE))\n\n# Transform the date column type with specified format\nt1$date <- as.Date(paste0(t1$date, \"-01-01\"))\n\n# Newly confirmed cases\nwide_data <- read_csv(\"Datasets/covid_confirmed_usafacts.csv\")\n\n# Define the key and value columns for pivoting\nkey_cols <- c(\"countyFIPS\", \"County Name\", \"State\", \"StateFIPS\")\nvalue_cols <- setdiff(names(wide_data), key_cols)\n\n# Pivot the data from wide to long\nlong_data <- pivot_longer(\n  wide_data,\n  cols = value_cols,\n  names_to = \"date\",\n  values_to = \"value\"\n)\n\n# Group by 'State' and 'date', and calculate the sum of Confirmed Cases\ncon_case_df <- long_data %>%\n  group_by(date) %>%\n  summarize(value_sum = sum(value, na.rm = TRUE))\n\n# Convert date column to Date format\ncon_case_df$date <- as.Date(con_case_df$date)\n\n# Aggregate data to monthly level using mean for each column\ncon_case_df <- con_case_df %>%\n  group_by(date = format(date, \"%Y-%m\")) %>%\n  summarize(value_sum = mean(value_sum, na.rm = TRUE))\n\n# Transform the date column type with specified format\ncon_case_df$date <- as.Date(paste0(con_case_df$date, \"-01-01\"))\n\n\nunemp <- read_csv('Datasets/unemployment.csv')\nkey_cols <- c(\"Location\")\nvalue_cols <- setdiff(names(unemp), key_cols)\nunemp1 <- pivot_longer(\n  unemp,\n  cols = value_cols,\n  names_to = \"Time\",\n  values_to = \"Unemployment\"\n)\n\n# Convert Time column to Date format\nunemp1$date <- as.Date(paste0(unemp1$Time, \"-01\"))\n\n# Convert Unemployment column to numeric (floating-point) format\nunemp1$Unemployment <- as.numeric(unemp1$Unemployment)\n\n# Focus on US\nunemp2 <- unemp1[unemp1$Location =='United States',]\nunemp3 <- unemp2[,c('date', 'Unemployment')]\n\n# Merge them together\ndd_df <- merge(t1, con_case_df, by = \"date\", all = FALSE)\nddd_df <- merge(dd_df, unemp3, by = \"date\", all = FALSE)\n\nhead(ddd_df)\n\n# Shape of the df\ncat('The shape of this dataframe is', dim(ddd_df))\n\n```\n\n## 2.4 Interdependence between Daily Vaccination Number and Independent Party Support Rate:\n**(VAR)Daily Vaccination Number \\~ Independent Party Support Rate** \n\nThis model evaluates how vaccination efforts and support for independent political parties influence each other over time.\n\n```{r, message=FALSE,warning=FALSE}\n# Read the dataset\nvac_df <- read_csv(\"Datasets/us_state_vaccinations.csv\")\n\n# Select relevant columns\ncols_show <- c('date', 'location', 'daily_vaccinations_per_million')\nt <- vac_df[, cols_show]\n\n# Group by 'date' and summarize columns, ignoring NA values\nt1 <- t %>%\n  group_by(date) %>%\n  summarize(\n    daily_vaccinations_per_million = sum(daily_vaccinations_per_million, na.rm = TRUE)\n  )\n\n# Convert date column to Date format\nt1$date <- as.Date(t1$date)\n\ndemo <- read_excel('Datasets/party.xlsx',sheet = 'Democrat')\ninde <- read_excel('Datasets/party.xlsx',sheet = 'Independent')\nrep <- read_excel('Datasets/party.xlsx',sheet = 'Republican')\n\n# Transform the wide dataframe into a long dataframe\nkey_cols <- c(\"Attitude\")\nvalue_cols <- setdiff(names(demo), key_cols)\ndemo1 <- pivot_longer(\n  demo,\n  cols = value_cols,\n  names_to = \"date\",\n  values_to = \"democrat\"\n)\n\ninde1 <- pivot_longer(\n  inde,\n  cols = value_cols,\n  names_to = \"date\",\n  values_to = \"independent\"\n)\n\nrep1 <- pivot_longer(\n  rep,\n  cols = value_cols,\n  names_to = \"date\",\n  values_to = \"republican\"\n)\n\n# Combine these three datasets together\ncombined_data <- full_join(demo1, inde1, by = c(\"date\", \"Attitude\")) %>%\n  full_join(rep1, by = c(\"date\", \"Attitude\"))\ncombined_data1 <- combined_data[combined_data$Attitude=='Favorable',]\n\n# Define the key and value columns for pivoting\nkey_cols <- c(\"Attitude\", \"date\")\nvalue_cols <- setdiff(names(combined_data1), key_cols)\n\n# Pivot the data from wide to long\ncombined_data2 <- pivot_longer(\n  combined_data1,\n  cols = value_cols,\n  names_to = \"Party\",\n  values_to = \"value\"\n)\n\n# Convert date column to Date format\ncombined_data2$date <- as.Date(combined_data2$date)\n\n# Subset to each party\ndemo_data <- combined_data2[combined_data2$Party=='democrat',][,c(\"date\",\"value\")]\ninde_data <- combined_data2[combined_data2$Party=='independent',][,c(\"date\",\"value\")]\nrep_data <- combined_data2[combined_data2$Party=='republican',][,c(\"date\",\"value\")]\n\ninde_df <- merge(t1, inde_data, by = \"date\", all = FALSE)\nhead(inde_df)\n\n# Shape of the df\ncat('The shape of this dataframe is', dim(inde_df))\n```\n\n## 2.5 Daily Vaccination Number and Democratic Party Support Rate Dynamics:\n**(VAR)Daily Vaccination Number \\~ Democratic Party Support Rate** \n\nHere, we assess the mutual influences between COVID-19 Daily Vaccination Numbers and support levels for the Democratic Party.\n\n```{r, message=FALSE,warning=FALSE}\ndemo_df <- merge(t1, demo_data, by = \"date\", all = FALSE)\nhead(demo_df)\n\n# Shape of the df\ncat('The shape of this dataframe is', dim(demo_df))\n```\n\n## 2.6 The Relationship between Daily Vaccination Number and Republican Party Support Rate:\n\n**(VAR)Daily Vaccination Number \\~ Republican Party Support Rate**\n\nThis model explores the bidirectional influence between vaccination initiatives and Republican Party support rates.\n\n```{r, message=FALSE,warning=FALSE}\nrep_df <- merge(t1, rep_data, by = \"date\", all = FALSE)\nhead(rep_df)\n\n# Shape of the df\ncat('The shape of this dataframe is', dim(rep_df))\n```\n\n# 3. ARIMAX/SARIMAX\n\n\n## 3.1 Variable Selection\n\nTo effectively construct an ARIMAX/SARIMAX model, it is crucial to select and define the response variable, which will serve as the primary focus of the analysis. Additionally, identifying relevant exogenous variables—those external predictor variables that are hypothesized to influence the response variable—is essential. This process involves a careful examination of potential predictors to ensure that they are not only relevant but also appropriately measured and free from collinearity issues. The selection of these variables should be guided by both theoretical considerations and empirical evidence, ensuring that they meaningfully contribute to the dynamics of the model. By integrating these exogenous variables, the ARIMAX/SARIMAX model can capture complex interactions and provide nuanced insights into how external factors may drive changes in the response variable over time.\n\n::: panel-tabset\n### (ARIMAX)Confirmed COVID-19 Cases \\~ Daily Vaccination Number\n```{r, message=FALSE,warning=FALSE}\ncava_df.ts<-ts(cava_df,star=decimal_date(as.Date(\"2020-12-20\",format = \"%Y-%m-%d\")),frequency = 365.25)\n\nautoplot(cava_df.ts[,c(2:3)], facets=TRUE, color=\"#5a3196\") +\n  xlab(\"Year\") + ylab(\"\") + theme_bw() +\n  ggtitle(\"Daily changes in new confirmed case and vaccination number\")\n\n```\n\n### (ARIMAX)COVID-19 Death Cases \\~ Daily Vaccination Number\n```{r, message=FALSE,warning=FALSE}\ndeva_df.ts<-ts(deva_df,star=decimal_date(as.Date(\"2020-12-20\",format = \"%Y-%m-%d\")),frequency = 365.25)\n\nautoplot(deva_df.ts[,c(2:3)], facets=TRUE, color=\"#5a3196\") +\n  xlab(\"Year\") + ylab(\"\") + theme_bw() +\n  ggtitle(\"Daily changes in dead case and new vaccination number\")\n\n```\n\n### (ARIMAX)Unemployment Rate \\~ Daily Vaccination Number + Confirmed COVID-19 Cases\n```{r, message=FALSE,warning=FALSE}\nddd_df.ts<-ts(ddd_df,star=decimal_date(as.Date(\"2020-12-01\",format = \"%Y-%m-%d\")),frequency = 12)\n\nautoplot(ddd_df.ts[,c(2:4)], facets=TRUE, color=\"#5a3196\") +\n  xlab(\"Year\") + ylab(\"\") + theme_bw() +\n  ggtitle(\"Monthly changes in new vaccination number, confirm case, and unemployment rate\")\n\n```\n:::\n\n## 3.2 Fit Auto.Arima()\n\n::: panel-tabset\n### (ARIMAX)Confirmed COVID-19 Cases \\~ Daily Vaccination Number\n```{r, message=FALSE,warning=FALSE}\nfit1 <- auto.arima(cava_df.ts[,\"value_sum\"],\n  xreg=cava_df.ts[,\"daily_vaccinations_per_million\"])\n\nsummary(fit1)\n\ncheckresiduals(fit1)\n\nmodel_output1 <- capture.output(sarima(residuals(fit1), 3,1,5)) \n\ncat(model_output1[76:91], model_output1[length(model_output1)], sep = \"\\n\")\n```\n\n- The **Standard Residual Plot** exhibits some inconsistencies in terms of mean and variance, suggesting potential issues with the model's assumptions about homoscedasticity or linearity.\n  \n- The **Autocorrelation Function (ACF)** plot reveals minimal correlation among residuals, suggesting that the model has effectively captured most of the underlying process; however, the presence of white noise indicates that the model may not be capturing all the data's nuances, which could point to an inadequate model fit.\n\n- The **Quantile-Quantile (Q-Q) Plot** shows that the residuals are mostly aligned with a normal distribution, suggesting that the normality assumption for the errors may largely hold, which is a positive indicator for the model’s reliability.\n\n- Results from the **Ljung-Box test** show p-values below the 0.05 significance level, which typically suggests a lack of fit as it indicates autocorrelation in the residuals at lag intervals that could influence the model's accuracy.\n\n- The coefficient table (**$ttable**) shows that the parameters ar1, ar2, ma4, and ma5 are statistically significant, highlighting their critical influence on the model's dynamics and underscoring the importance of these terms in explaining the time series variability.\n\n\n### (ARIMAX)COVID-19 Death Cases \\~ Daily Vaccination Number\n```{r, message=FALSE,warning=FALSE}\nfit2 <- auto.arima(deva_df.ts[,\"value_sum\"],\n  xreg=deva_df.ts[,\"daily_vaccinations_per_million\"])\n\nsummary(fit2)\n\ncheckresiduals(fit2)\n\nmodel_output2 <- capture.output(sarima(residuals(fit2), 5,2,2)) \n\ncat(model_output2[77:90], model_output2[length(model_output2)], sep = \"\\n\")\n\n```\n\n- The **Standard Residual Plot** suggests some irregularities in both the mean and the variance of the residuals, pointing to potential issues in the homoscedasticity or distribution assumptions of the model.\n\n- The **Autocorrelation Function (ACF) Plot** reveals minimal correlation among residuals, suggesting that most of the systematic information in the data has been captured by the model. However, the presence of any remaining correlation, albeit slight, could indicate that the model might not be capturing all underlying patterns effectively, which is indicative of a suboptimal fit.\n\n- The **Quantile-Quantile (Q-Q) Plot** shows that the residuals are approximately normally distributed, with only minor deviations from normality. This aspect of the diagnostics is generally positive, indicating that the assumption of normality is reasonably satisfied.\n\n- Results from the **Ljung-Box Test** show p-values below the 0.05 significance level, suggesting that there is still some autocorrelation present in the residuals at lagged intervals. This result contradicts the ideal scenario where p-values would significantly exceed the threshold, confirming the absence of autocorrelation and a good fit.\n\n- **Coefficient Significance Table**: All the coefficients in the model are statistically significant, suggesting that each predictor contributes meaningfully to the model. However, significance of coefficients alone does not necessarily imply an overall effective model fit, as it does not account for potential issues in other diagnostic areas.\n\n\n### (ARIMAX)Unemployment Rate \\~ Daily Vaccination Number + Confirmed COVID-19 Cases\n```{r, message=FALSE,warning=FALSE}\nfit3 <- auto.arima(ddd_df.ts[,\"Unemployment\"],\n  xreg=ddd_df.ts[,2:3])\n\nsummary(fit3)\n\ncheckresiduals(fit3)\n\nmodel_output3 <- capture.output(sarima(residuals(fit3), 0,0,0)) \n\ncat(model_output3[11:18], model_output3[length(model_output3)], sep = \"\\n\")\n\n```\n\n- The **Standard Residual Plot** reveals some inconsistencies in the mean and variance, suggesting potential deviations from homoscedasticity or the presence of outliers that could affect the robustness of the model predictions.\n  \n- The **Autocorrelation Function (ACF) Plot** exhibits minimal correlation among the residuals, which suggests that the model has effectively captured the underlying patterns in the data, leaving behind what appears to be white noise. This is a strong indicator of a well-fitting model.\n  \n- The **Quantile-Quantile (Q-Q) Plot** closely aligns with the theoretical normal distribution, underscoring the assumption of normality in the model's residuals, which is essential for the validity of many inferential statistics.\n  \n- The **Ljung-Box Test** results are mixed, with half of the p-values falling below the 0.05 significance threshold. This inconsistency suggests that some autocorrelations at different lags are significantly different from zero, indicating potential issues with the model fit.\n  \n- **Significance Table**: The statistical significance of all model coefficients is affirmed, implying that each predictor contributes meaningfully to the model. This significance is crucial for understanding the impact of each variable within the model and for making informed predictions or decisions based on the model’s outputs.\n\n:::\n\n\n## 3.3 Manually Fit\n\n::: panel-tabset\n### (ARIMAX)Confirmed COVID-19 Cases \\~ Daily Vaccination Number\n```{r, message=FALSE,warning=FALSE}\nfit.reg <- lm(value_sum ~ daily_vaccinations_per_million, data=cava_df.ts)\nsummary(fit.reg)\n```\n\nThe variables appear to be significant. Next, looking at the ACF/PACF plot of the residuals.\n\n```{r, message=FALSE,warning=FALSE}\nres.fit1<-ts(residuals(fit.reg),start = decimal_date(as.Date(\"2020-12-20\", format = \"%Y-%m-%d\")),frequency = 365.25)\n\nplot1<-ggAcf(res.fit1,20) + theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \nplot2<- ggPacf(res.fit1,20)+theme_bw()+ theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \n\ngrid.arrange(plot1, plot2,nrow=2)\n```\n\nThere appears to be seasonality still, so I will apply some differencing.\n\n```{r, message=FALSE,warning=FALSE}\nplot1<-ggAcf(diff(res.fit1),20) + theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \nplot2<- ggPacf(diff(res.fit1),20)+theme_bw()+ theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \n\ngrid.arrange(plot1, plot2,nrow=2)\n```\n\nAccording to the plots, we have the following values: p = 1,2,3 q= 1,2,3.\n\n```{r, message=FALSE,warning=FALSE}\nd=1\ni=1\ntemp= data.frame()\nls=matrix(rep(NA,6*32),nrow=32) \n\n\nfor (p in 0:3)\n{\n  for(q in 0:3)\n  {\n    for(d in 0:1)\n    {\n      \n      if(p-1+d+q-1<=8) #usual threshold\n      {\n        \n        model<- Arima(res.fit1/10000,order=c(p,d,q),include.drift=TRUE) \n        ls[i,]= c(p,d,q,model$aic,model$bic,model$aicc)\n        i=i+1\n        #print(i)\n        \n      }\n      \n    }\n  }\n}\n\n\ntemp= as.data.frame(ls)\nnames(temp)= c(\"p\",\"d\",\"q\",\"AIC\",\"BIC\",\"AICc\")\n\n#temp\nknitr::kable(temp)\n\ntemp[which.min(temp$AIC),] \n\ntemp[which.min(temp$BIC),]\n\ntemp[which.min(temp$AICc),]\n```\n\nThis gives me a Regression with model ARIMA(3,1,3).\n\n```{r}\nmodel_output1 <- capture.output(sarima(res.fit1, 3,1,3)) \n\ncat(model_output1[73:86], model_output1[length(model_output1)], sep = \"\\n\")\n```\n\n- The **Standard Residual Plot** exhibits some inconsistencies in terms of mean and variance, suggesting potential issues with the model's assumptions about homoscedasticity or linearity.\n  \n- The **Autocorrelation Function (ACF) Plot** exhibits minimal correlation among the residuals, which suggests that the model has effectively captured the underlying patterns in the data, leaving behind what appears to be white noise. This is a strong indicator of a well-fitting model.\n\n- The **Quantile-Quantile (Q-Q) Plot** shows that the residuals are mostly aligned with a normal distribution, suggesting that the normality assumption for the errors may largely hold, which is a positive indicator for the model’s reliability.\n\n- Results from the **Ljung-Box test** show p-values below the 0.05 significance level, which typically suggests a lack of fit as it indicates autocorrelation in the residuals at lag intervals that could influence the model's accuracy.\n\n- **Significance Table**: The statistical significance of all model coefficients is affirmed, implying that each predictor contributes meaningfully to the model. This significance is crucial for understanding the impact of each variable within the model and for making informed predictions or decisions based on the model’s outputs.\n\n\n### (ARIMAX)COVID-19 Death Cases \\~ Daily Vaccination Number\n```{r, message=FALSE,warning=FALSE}\nfit.reg <- lm(value_sum ~ daily_vaccinations_per_million, data=deva_df.ts)\nsummary(fit.reg)\n```\n\nThe variables appear to be significant. Next, looking at the ACF/PACF plot of the residuals.\n\n```{r, message=FALSE,warning=FALSE}\nres.fit1<-ts(residuals(fit.reg),start = decimal_date(as.Date(\"2020-12-20\", format = \"%Y-%m-%d\")),frequency = 365.25)\n\nplot1<-ggAcf(res.fit1,20) + theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \nplot2<- ggPacf(res.fit1,20)+theme_bw()+ theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \n\ngrid.arrange(plot1, plot2,nrow=2)\n```\n\nThere appears to be seasonality still, so I will apply some differencing.\n\n```{r, message=FALSE,warning=FALSE}\nplot1<-ggAcf(diff(res.fit1),20) + theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \nplot2<- ggPacf(diff(res.fit1),20)+theme_bw()+ theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \n\ngrid.arrange(plot1, plot2,nrow=2)\n```\n\nAccording to the plots, we have the following values: p = 1,2,3 q= 1,2,3.\n\n```{r, message=FALSE,warning=FALSE}\nd=1\ni=1\ntemp= data.frame()\nls=matrix(rep(NA,6*32),nrow=32) \n\n\nfor (p in 0:3)\n{\n  for(q in 0:3)\n  {\n    for(d in 0:1)\n    {\n      \n      if(p-1+d+q-1<=8) #usual threshold\n      {\n        \n        model<- Arima(res.fit1/10000,order=c(p,d,q),include.drift=TRUE) \n        ls[i,]= c(p,d,q,model$aic,model$bic,model$aicc)\n        i=i+1\n        #print(i)\n        \n      }\n      \n    }\n  }\n}\n\n\ntemp= as.data.frame(ls)\nnames(temp)= c(\"p\",\"d\",\"q\",\"AIC\",\"BIC\",\"AICc\")\n\n#temp\nknitr::kable(temp)\n\ntemp[which.min(temp$AIC),] \n\ntemp[which.min(temp$BIC),]\n\ntemp[which.min(temp$AICc),]\n```\n\nThis gives me a Regression with model ARIMA(3,1,3).\n\n```{r}\nmodel_output1 <- capture.output(sarima(res.fit1, 3,1,3)) \n\ncat(model_output1[77:90], model_output1[length(model_output1)], sep = \"\\n\")\n```\n\n- The **Standard Residual Plot** exhibits some inconsistencies in terms of mean and variance, suggesting potential issues with the model's assumptions about homoscedasticity or linearity.\n  \n- The **Autocorrelation Function (ACF) Plot** exhibits minimal correlation among the residuals, which suggests that the model has effectively captured the underlying patterns in the data, leaving behind what appears to be white noise. This is a strong indicator of a well-fitting model.\n\n- The **Quantile-Quantile (Q-Q) Plot** shows that the residuals are mostly aligned with a normal distribution, suggesting that the normality assumption for the errors may largely hold, which is a positive indicator for the model’s reliability.\n\n- Results from the **Ljung-Box test** show p-values below the 0.05 significance level, which typically suggests a lack of fit as it indicates autocorrelation in the residuals at lag intervals that could influence the model's accuracy.\n\n- **Significance Table**: The statistical significance of all model coefficients is affirmed, implying that each predictor contributes meaningfully to the model. This significance is crucial for understanding the impact of each variable within the model and for making informed predictions or decisions based on the model’s outputs.\n\n\n### (ARIMAX)Unemployment Rate \\~ Daily Vaccination Number + Confirmed COVID-19 Cases\n```{r, message=FALSE,warning=FALSE}\nfit.reg <- lm(Unemployment ~ daily_vaccinations_per_million + value_sum, data=ddd_df.ts)\nsummary(fit.reg)\n```\n\nThe confirmed COVID-19 case number appears to be significant. Next, looking at the ACF/PACF plot of the residuals.\n\n```{r, message=FALSE,warning=FALSE}\nres.fit1<-ts(residuals(fit.reg),start = decimal_date(as.Date(\"2020-12-01\", format = \"%Y-%m-%d\")),frequency = 12)\n\nplot1<-ggAcf(res.fit1) + theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \nplot2<- ggPacf(res.fit1)+theme_bw()+ theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \n\ngrid.arrange(plot1, plot2,nrow=2)\n```\n\nAccording to the plots, we have the following values: p = 1 q= 1.\n\n```{r, message=FALSE,warning=FALSE}\nd=1\ni=1\ntemp= data.frame()\nls=matrix(rep(NA,6*8),nrow=8) \n\n\nfor (p in 0:1)\n{\n  for(q in 0:1)\n  {\n    for(d in 0:1)\n    {\n      \n      if(p-1+d+q-1<=8) #usual threshold\n      {\n        \n        model<- Arima(res.fit1/10000,order=c(p,d,q),include.drift=TRUE) \n        ls[i,]= c(p,d,q,model$aic,model$bic,model$aicc)\n        i=i+1\n        #print(i)\n        \n      }\n      \n    }\n  }\n}\n\n\ntemp= as.data.frame(ls)\nnames(temp)= c(\"p\",\"d\",\"q\",\"AIC\",\"BIC\",\"AICc\")\n\n#temp\nknitr::kable(temp)\n\ntemp[which.min(temp$AIC),] \n\ntemp[which.min(temp$BIC),]\n\ntemp[which.min(temp$AICc),]\n```\n\nThis gives me a Regression with model ARIMA(1,0,0).\n\n```{r}\nmodel_output1 <- capture.output(sarima(res.fit1, 1,0,0)) \n\ncat(model_output1[21:29], model_output1[length(model_output1)], sep = \"\\n\")\n```\n\n- The **Standard Residual Plot** exhibits some inconsistencies in terms of mean and variance, suggesting potential issues with the model's assumptions about homoscedasticity or linearity.\n  \n- The **Autocorrelation Function (ACF) Plot** exhibits minimal correlation among the residuals, which suggests that the model has effectively captured the underlying patterns in the data, leaving behind what appears to be white noise. This is a strong indicator of a well-fitting model.\n\n- The **Quantile-Quantile (Q-Q) Plot** shows that the residuals are mostly aligned with a normal distribution, suggesting that the normality assumption for the errors may largely hold, which is a positive indicator for the model’s reliability.\n\n- Results from the **Ljung-Box test** show p-values above the 0.05 significance level, which typically suggests a good fit as it indicates autocorrelation in the residuals at lag intervals.\n\n- **Significance Table**: The statistical significance of all model coefficients is affirmed, implying that each predictor contributes meaningfully to the model. This significance is crucial for understanding the impact of each variable within the model and for making informed predictions or decisions based on the model’s outputs.\n\n:::\n\n## 3.4 Cross Validation\n\nTo confirm our selection on the model, we choose to use cross validation to compare the RMSE values to help us make decision.\n\n::: panel-tabset\n### (ARIMAX)Confirmed COVID-19 Cases \\~ Daily Vaccination Number\n\nAuto.arima gave me ARIMA(3,1,5), while the manual model selection resulted in ARIMA(3,1,3).\n\n```{r, message=FALSE,warning=FALSE}\nfit.reg <- lm(value_sum ~ daily_vaccinations_per_million, data=cava_df.ts)\nres.fit1<-ts(residuals(fit.reg),start = decimal_date(as.Date(\"2020-12-20\", format = \"%Y-%m-%d\")),frequency = 365.25)\n\nn = length(res.fit1) # 872\nk = 220\n\ni=1\nerr1 = c()\nerr2 = c()\n\nfor(i in 1:(n-k))\n{\n  xtrain <- res.fit1[1:(k-1)+i] #observations from 1 to 12\n  xtest <- res.fit1[k+i] #13th observation as the test set\n  \n  fit1 <- Arima(xtrain, order=c(3,1,5),include.drift=FALSE, method=\"ML\")\n  fcast1 <- forecast(fit1, h=1)\n  \n  fit2 <- Arima(xtrain, order=c(3,1,3),include.drift=FALSE, method=\"ML\")\n  fcast2 <- forecast(fit2, h=1)\n\n  \n  #capture error for each iteration\n  # This is mean absolute error\n  err1 = c(err1, abs(fcast1$mean-xtest)) \n  err2 = c(err2, abs(fcast2$mean-xtest))\n  \n  # This is mean squared error\n  err3 = c(err1, (fcast1$mean-xtest)^2)\n  err4 = c(err2, (fcast2$mean-xtest)^2)\n  #print(i)\n}\n\nRMSE1 <- sqrt(mean(err3, na.rm = TRUE))\nRMSE2 <- sqrt(mean(err4, na.rm = TRUE))\n\ncat('The RMSE of Auto Arima is', RMSE1, '\\n')\ncat('The RMSE of Manually Selection is', RMSE2, '\\n')\n```\n\nThe Auto Arima model had lower RMSE compared to the manual model. Therefore, the best model is ARIMA(3,1,5).\n\n### (ARIMAX)COVID-19 Death Cases \\~ Daily Vaccination Number\n\nAuto.arima gave me ARIMA(5,2,2), while the manual model selection resulted in ARIMA(3,1,3).\n\n```{r, message=FALSE,warning=FALSE}\nfit.reg <- lm(value_sum ~ daily_vaccinations_per_million, data=deva_df.ts)\nres.fit1<-ts(residuals(fit.reg),start = decimal_date(as.Date(\"2020-12-20\", format = \"%Y-%m-%d\")),frequency = 365.25)\n\nn = length(res.fit1) # 872\nk = 220\n\ni=1\nerr1 = c()\nerr2 = c()\n\nfor(i in 1:(n-k))\n{\n  xtrain <- res.fit1[1:(k-1)+i] #observations from 1 to 12\n  xtest <- res.fit1[k+i] #13th observation as the test set\n  \n  fit1 <- Arima(xtrain, order=c(5,2,2),include.drift=FALSE, method=\"ML\")\n  fcast1 <- forecast(fit1, h=1)\n  \n  fit2 <- Arima(xtrain, order=c(3,1,3),include.drift=FALSE, method=\"ML\")\n  fcast2 <- forecast(fit2, h=1)\n\n  \n  #capture error for each iteration\n  # This is mean absolute error\n  err1 = c(err1, abs(fcast1$mean-xtest)) \n  err2 = c(err2, abs(fcast2$mean-xtest))\n  \n  # This is mean squared error\n  err3 = c(err1, (fcast1$mean-xtest)^2)\n  err4 = c(err2, (fcast2$mean-xtest)^2)\n  #print(i)\n}\n\nRMSE1 <- sqrt(mean(err3, na.rm = TRUE))\nRMSE2 <- sqrt(mean(err4, na.rm = TRUE))\n\ncat('The RMSE of Auto Arima is', RMSE1, '\\n')\ncat('The RMSE of Manually Selection is', RMSE2, '\\n')\n```\n\nThe manual model had lower RMSE compared to the Auto Arima model. Therefore, the best model is ARIMA(3,1,3).\n\n### (ARIMAX)Unemployment Rate \\~ Daily Vaccination Number + Confirmed COVID-19 Cases\n\nAuto.arima gave me ARIMA(0,0,0), while the manual model selection resulted in ARIMA(1,0,0). Since the data sample for this time series only contains 16 observations, we choose to use ARIMA(1,0,0) since ARIMA(0,0,0) contains more biases\n\n:::\n\n\n## 3.5 Model Fitting\n\nIn this section, we will use the best model to fit the model.\n\n::: panel-tabset\n### (ARIMAX)Confirmed COVID-19 Cases \\~ Daily Vaccination Number\n\nThe best ARIMAX model for this relationship is ARIMA(3,1,5).\n\n```{r, message=FALSE,warning=FALSE}\nfit1 <- Arima(cava_df.ts[,\"value_sum\"],order=c(3,1,5), xreg=cava_df.ts[,\"daily_vaccinations_per_million\"])\nsummary(fit1)\n```\n\n**Equation:**\n\n$$ \\nabla Y_t = \\mu - 0.0956 \\nabla Y_{t-1} + 0.533 \\nabla Y_{t-2} + 0.5298 \\nabla Y_{t-3} + 0.2741 \\epsilon_{t-1} - 0.6293 \\epsilon_{t-2} - 0.6067 \\epsilon_{t-3} + 0.3318 \\epsilon_{t-4} + 0.5648 \\epsilon_{t-5} - 0.0029 X_t + \\epsilon_t  $$\n\n\n\n### (ARIMAX)COVID-19 Death Cases \\~ Daily Vaccination Number\n\nThe best ARIMAX model for this relationship is ARIMA(3,1,3).\n\n```{r, message=FALSE,warning=FALSE}\nfit1 <- Arima(deva_df.ts[,\"value_sum\"],order=c(3,1,3), xreg=deva_df.ts[,\"daily_vaccinations_per_million\"])\nsummary(fit1)\n```\n\n**Equation:**\n\n$$ \\nabla Y_t = \\mu + 0.5142 \\nabla Y_{t-1} - 0.4725 \\nabla Y_{t-2} + 0.9553 \\nabla Y_{t-3} - 0.3085 \\epsilon_{t-1} + 0.4341 \\epsilon_{t-2} - 0.8067 \\epsilon_{t-3} + 0.0018 X_t + \\epsilon_t  $$\n\n### (ARIMAX)Unemployment Rate \\~ Daily Vaccination Number + Confirmed COVID-19 Cases\n\nThe best ARIMAX model for this relationship is ARIMA(1,0,0).\n\n```{r, message=FALSE,warning=FALSE}\nfit1 <- Arima(ddd_df.ts[,\"Unemployment\"],order=c(1,0,0), xreg=ddd_df.ts[,2:3])\nsummary(fit1)\n```\n\n**Equation:**\n\n$$ \\nabla Y_t = 0.066 + 0.897 \\nabla Y_{t-1} + \\epsilon_t  $$\n\n:::\n\n## 3.6 Forecast\n\nThen, I use the best model for each relationship and forecast the values. \n\n::: panel-tabset\n### (ARIMAX)Confirmed COVID-19 Cases \\~ Daily Vaccination Number\n\n```{r, message=FALSE,warning=FALSE}\nfit1 <- Arima(cava_df.ts[,\"value_sum\"],order=c(3,1,5), xreg=cava_df.ts[,\"daily_vaccinations_per_million\"])\nforecast(fit1, h = 100, xreg=cava_df.ts[,\"daily_vaccinations_per_million\"]) %>%\n  autoplot() + xlab(\"Date\")+ theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \n```\n\nIn summary, this forecast suggests that, according to the ARIMA(3,1,5) model used, the daily confirmed cases are expected to remain at a consistent level in the near term, with the uncertainty of the forecast increasing as it projects further out into the future.\n\n### (ARIMAX)COVID-19 Death Cases \\~ Daily Vaccination Number\n\n```{r, message=FALSE,warning=FALSE}\nfit1 <- Arima(deva_df.ts[,\"value_sum\"],order=c(3,1,3), xreg=deva_df.ts[,\"daily_vaccinations_per_million\"])\nforecast(fit1, h = 100, xreg=deva_df.ts[,\"daily_vaccinations_per_million\"]) %>%\n  autoplot() + xlab(\"Date\")+ theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \n```\n\nIn summary, this forecast suggests that, according to the ARIMA(3,1,3) model used, the daily dead cases are expected to remain at a consistent level in the near term, with the uncertainty of the forecast increasing as it projects further out into the future.\n\n### (ARIMAX)Unemployment Rate \\~ Daily Vaccination Number + Confirmed COVID-19 Cases\n\n```{r, message=FALSE,warning=FALSE}\nfit1 <- Arima(ddd_df.ts[,\"Unemployment\"],order=c(1,0,0), xreg=ddd_df.ts[,2:3])\nforecast(fit1, h = 4, xreg=ddd_df.ts[,2:3]) %>%\n  autoplot() + xlab(\"Month\")+ theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \n```\n\nIn summary, the model seems to predict that the decreasing trend in unemployment observed in the actual data will not persist in the same way, and that unemployment may stabilize at the levels seen at the end of the observed data.\n\n:::\n\n\n# 4. VAR\n\n## 4.1 Variable Selection\n\nWhen crafting a VAR model, it is pivotal to delineate each variable that will be considered within the system. Unlike ARIMAX/SARIMAX models, which focus on a primary response variable influenced by exogenous predictors, VAR models treat all included variables as endogenously interrelated. Each variable in a VAR model is explained by its own lagged values as well as the lagged values of all other variables in the system, allowing for a multidirectional analysis of influence and response over time.\n\nThe selection process for variables in a VAR model is underpinned by both theoretical frameworks and empirical data, necessitating a rigorous review to ascertain their interconnectedness and the absence of unit roots that may indicate non-stationarity. This ensures that each variable not only possesses inherent relevance but also contributes to a comprehensive understanding of the system's internal dynamics. By employing a VAR model, one can dissect and comprehend the nuanced interplay between variables, enabling a holistic view of how each variable evolves in relation to others within the dataset.\n\n::: panel-tabset\n### (VAR)Daily Vaccination Number \\~ Independent Party Support Rate\n\n```{r, message=FALSE,warning=FALSE}\ninde_df.ts<-ts(inde_df,star=decimal_date(as.Date(\"2020-12-22\",format = \"%Y-%m-%d\")),frequency = 52)\n\nautoplot(inde_df.ts[,c(2:3)], facets=TRUE, color=\"#5a3196\") +\n  xlab(\"Year\") + ylab(\"\") + theme_bw() +\n  ggtitle(\"Daily changes in new vaccination number and independent party support rate\")\n```\n\n### (VAR)Daily Vaccination Number \\~ Democratic Party Support Rate\n\n```{r, message=FALSE,warning=FALSE}\ndemo_df.ts<-ts(demo_df,star=decimal_date(as.Date(\"2020-12-22\",format = \"%Y-%m-%d\")),frequency = 52)\n\nautoplot(demo_df.ts[,c(2:3)], facets=TRUE, color=\"#5a3196\") +\n  xlab(\"Year\") + ylab(\"\") + theme_bw() +\n  ggtitle(\"Daily changes in new vaccination number and democratic party support rate\")\n\n```\n\n### (VAR)Daily Vaccination Number \\~ Republican Party Support Rate\n\n```{r, message=FALSE,warning=FALSE}\nrep_df.ts<-ts(rep_df,star=decimal_date(as.Date(\"2020-12-22\",format = \"%Y-%m-%d\")),frequency = 52)\n\nautoplot(rep_df.ts[,c(2:3)], facets=TRUE, color=\"#5a3196\") +\n  xlab(\"Year\") + ylab(\"\") + theme_bw() +\n  ggtitle(\"Daily changes in new vaccination number and republican party support rate\")\n```\n:::\n\n## 4.2 Variable Selection\n\nIn the process of refining our VAR model, a critical step involves selecting the optimal number of lag periods, denoted as \\( p \\). This selection is pivotal as it significantly influences the model's accuracy and effectiveness in capturing the dynamics between the time series variables. To determine the best \\( p \\), we utilize criteria such as the Akaike Information Criterion (AIC), the Bayesian Information Criterion (BIC), and the Hannan-Quinn Information Criterion (HQIC), which help in balancing model complexity and goodness of fit.\n\n::: panel-tabset\n### (VAR)Daily Vaccination Number \\~ Independent Party Support Rate\n\n```{r, message=FALSE,warning=FALSE}\nVARselect(inde_df.ts, lag.max=10, type=\"both\")\n```\n\nAccording to the selection criterion, we select the model with p=1 and 3.\n\n```{r, message=FALSE,warning=FALSE}\nsummary(vars::VAR(inde_df.ts, p=1, type='both'))\n```\n\n```{r, message=FALSE,warning=FALSE}\nsummary(vars::VAR(inde_df.ts, p=3, type='both'))\n```\n\nExamining the VAR models with \\( p = 1 \\) and \\( p = 3 \\) lag orders, we notice the presence of some variables that do not significantly contribute to the model. Notably, the model with \\( p = 3 \\) lag periods tends to have fewer significant variables compared to the \\( p = 1 \\) model. However, opting for \\( p = 1 \\) may overly simplify the model, potentially failing to capture all the relevant and significant relationships among the variables. Thus, while \\( p = 1 \\) offers a more parsimonious model, it might not sufficiently account for the complexity of the dynamics within the data, suggesting that a balance must be struck between model simplicity and its ability to elucidate significant interactions.\n\n### (VAR)Daily Vaccination Number \\~ Democratic Party Support Rate\n\n```{r, message=FALSE,warning=FALSE}\nVARselect(demo_df.ts, lag.max=10, type=\"both\")\n```\n\nAccording to the selection criterion, we select the model with p=1 and 6.\n\n```{r, message=FALSE,warning=FALSE}\nsummary(vars::VAR(demo_df.ts, p=1, type='both'))\n```\n\n```{r, message=FALSE,warning=FALSE}\nsummary(vars::VAR(demo_df.ts, p=6, type='both'))\n```\n\nFrom the perspective of the p-values associated with these models, each demonstrates a moderate number of significant variables. Although a model with \\( p = 1 \\) lag might appear overly simplistic and possibly inadequate for capturing the full dynamics of the dataset, a model with \\( p = 6 \\) lags could potentially offer a slight improvement. This enhancement in performance suggests that incorporating more lag terms allows the VAR model to better account for the temporal dependencies among the variables, thus providing a more accurate and insightful analysis.\n\n### (VAR)Daily Vaccination Number \\~ Republican Party Support Rate\n\n```{r, message=FALSE,warning=FALSE}\nVARselect(rep_df.ts, lag.max=10, type=\"both\")\n```\n\nAccording to the selection criterion, we select the model with p=1 and 5(second lowest AIC).\n\n```{r, message=FALSE,warning=FALSE}\nsummary(vars::VAR(rep_df.ts, p=1, type='both'))\n```\n\n```{r, message=FALSE,warning=FALSE}\nsummary(vars::VAR(rep_df.ts, p=5, type='both'))\n```\n\nExamining the VAR models with \\( p = 1 \\) and \\( p = 5 \\) lag orders, we notice the presence of some variables that do not significantly contribute to the model. Notably, the model with \\( p = 5 \\) lag periods tends to have fewer significant variables compared to the \\( p = 1 \\) model. However, opting for \\( p = 1 \\) may overly simplify the model, potentially failing to capture all the relevant and significant relationships among the variables. Thus, while \\( p = 1 \\) offers a more parsimonious model, it might not sufficiently account for the complexity of the dynamics within the data, suggesting that a balance must be struck between model simplicity and its ability to elucidate significant interactions.\n\n:::\n\n\n## 4.3 Cross Validation\n\nTo validate our hypothesis and ensure the robustness of our model selection, we employ cross-validation to compare the Root Mean Squared Error (RMSE) of the two chosen models. By assessing the RMSE, we can quantitatively determine which model provides a more accurate fit to the data.\n\n::: panel-tabset\n### (VAR)Daily Vaccination Number \\~ Independent Party Support Rate\n\n```{r, message=FALSE,warning=FALSE}\n#n=length(inde_df.ts) 351\n#n-k=91; 260/52=5;\nn=length(inde_df.ts)\nk=91\n\nrmse1 <- matrix(NA, 52,5)\nrmse2 <- matrix(NA, 52,5)\nweek<-c()\n\n# Convert data frame to time series object\nst <- tsp(inde_df.ts )[1]+(k-1)/52\n\n\nfor(i in 1:1)\n{\n  \n  xtrain <- window(inde_df.ts, end=st + i-1)\n  xtest <- window(inde_df.ts, start=st + (i-1) + 1/52, end=st + i)\n  \n  ######## first Model ############\n  fit <- VAR(inde_df.ts, p=3, type='both')\n  fcast <- predict(fit, n.ahead = 52)\n  \n  fvacc<-fcast$fcst$daily_vaccinations_per_million\n  fsupp<-fcast$fcst$value\n\n  ff<-data.frame(fvacc[,1],fsupp[,1]) #collecting the forecasts for 3 variables\n  \n  week<-st + (i-1) + 1/52 \n  \n  ff<-ts(ff,start=c(week,1),frequency = 52)\n  \n  a = 52*i-51 \n  b = 52*i \n  \n  ##### collecting errors ######\n  rmse1[c(a:b),]  <-sqrt((ff-xtest[,2:3])^2)\n  \n  ######## Second Model ############\n  fit2 <- vars::VAR(inde_df.ts, p=1, type='both')\n  fcast2 <- predict(fit2, n.ahead = 52)\n  \n  fvacc<-fcast2$fcst$daily_vaccinations_per_million\n  fsupp<-fcast2$fcst$value\n\n  ff2<-data.frame(fvacc[,1],fsupp[,1])\n  \n  week<-st + (i-1) + 1/52\n  \n  ff2<-ts(ff2,start=c(week,1),frequency = 52)\n  \n  a = 52*i-51 \n  b = 52*i\n  rmse2[c(a:b),]  <-sqrt((ff2-xtest[,2:3])^2)\n}\n```\n\n```{r, message=FALSE,warning=FALSE}\nplot(1:52, rowMeans(rmse1,na.rm=TRUE), type=\"l\", col=2, xlab=\"Week\", ylab=\"RMSE\")\nlines(1:52, rowMeans(rmse2,na.rm=TRUE), type=\"l\",col=3)\nlegend(\"topleft\",legend=c(\"VAR 3\",\"VAR 1\"),col=2:4,lty=1)\n```\n\nVAR(1) appears to have lower RMSE than VAR(3), therefore VAR(1) is a better fit.\n\n### (VAR)Daily Vaccination Number \\~ Democratic Party Support Rate\n\n```{r, message=FALSE,warning=FALSE}\n#n=length(inde_df.ts) 351\n#n-k=91; 260/52=5;\nn=length(demo_df.ts)\nk=91\n\nrmse1 <- matrix(NA, 52,5)\nrmse2 <- matrix(NA, 52,5)\nweek<-c()\n\n# Convert data frame to time series object\nst <- tsp(demo_df.ts )[1]+(k-1)/52\n\n\nfor(i in 1:1)\n{\n  \n  xtrain <- window(demo_df.ts, end=st + i-1)\n  xtest <- window(demo_df.ts, start=st + (i-1) + 1/52, end=st + i)\n  \n  ######## first Model ############\n  fit <- VAR(demo_df.ts, p=6, type='both')\n  fcast <- predict(fit, n.ahead = 52)\n  \n  fvacc<-fcast$fcst$daily_vaccinations_per_million\n  fsupp<-fcast$fcst$value\n\n  ff<-data.frame(fvacc[,1],fsupp[,1]) #collecting the forecasts for 3 variables\n  \n  week<-st + (i-1) + 1/52 \n  \n  ff<-ts(ff,start=c(week,1),frequency = 52)\n  \n  a = 52*i-51 \n  b = 52*i \n  \n  ##### collecting errors ######\n  rmse1[c(a:b),]  <-sqrt((ff-xtest[,2:3])^2)\n  \n  ######## Second Model ############\n  fit2 <- vars::VAR(demo_df.ts, p=1, type='both')\n  fcast2 <- predict(fit2, n.ahead = 52)\n  \n  fvacc<-fcast2$fcst$daily_vaccinations_per_million\n  fsupp<-fcast2$fcst$value\n\n  ff2<-data.frame(fvacc[,1],fsupp[,1])\n  \n  week<-st + (i-1) + 1/52\n  \n  ff2<-ts(ff2,start=c(week,1),frequency = 52)\n  \n  a = 52*i-51 \n  b = 52*i\n  rmse2[c(a:b),]  <-sqrt((ff2-xtest[,2:3])^2)\n}\n```\n\n```{r, message=FALSE,warning=FALSE}\nplot(1:52, rowMeans(rmse1,na.rm=TRUE), type=\"l\", col=2, xlab=\"Week\", ylab=\"RMSE\")\nlines(1:52, rowMeans(rmse2,na.rm=TRUE), type=\"l\",col=3)\nlegend(\"topleft\",legend=c(\"VAR 6\",\"VAR 1\"),col=2:4,lty=1)\n```\n\nVAR(6) appears to have lower RMSE than VAR(1), therefore VAR(6) is a better fit.\n\n### (VAR)Daily Vaccination Number \\~ Republican Party Support Rate\n\n```{r, message=FALSE,warning=FALSE}\n#n=length(inde_df.ts) 351\n#n-k=91; 260/52=5;\nn=length(rep_df.ts)\nk=91\n\nrmse1 <- matrix(NA, 52,5)\nrmse2 <- matrix(NA, 52,5)\nweek<-c()\n\n# Convert data frame to time series object\nst <- tsp(rep_df.ts )[1]+(k-1)/52\n\n\nfor(i in 1:1)\n{\n  \n  xtrain <- window(rep_df.ts, end=st + i-1)\n  xtest <- window(rep_df.ts, start=st + (i-1) + 1/52, end=st + i)\n  \n  ######## first Model ############\n  fit <- VAR(rep_df.ts, p=5, type='both')\n  fcast <- predict(fit, n.ahead = 52)\n  \n  fvacc<-fcast$fcst$daily_vaccinations_per_million\n  fsupp<-fcast$fcst$value\n\n  ff<-data.frame(fvacc[,1],fsupp[,1]) #collecting the forecasts for 3 variables\n  \n  week<-st + (i-1) + 1/52 \n  \n  ff<-ts(ff,start=c(week,1),frequency = 52)\n  \n  a = 52*i-51 \n  b = 52*i \n  \n  ##### collecting errors ######\n  rmse1[c(a:b),]  <-sqrt((ff-xtest[,2:3])^2)\n  \n  ######## Second Model ############\n  fit2 <- vars::VAR(rep_df.ts, p=1, type='both')\n  fcast2 <- predict(fit2, n.ahead = 52)\n  \n  fvacc<-fcast2$fcst$daily_vaccinations_per_million\n  fsupp<-fcast2$fcst$value\n\n  ff2<-data.frame(fvacc[,1],fsupp[,1])\n  \n  week<-st + (i-1) + 1/52\n  \n  ff2<-ts(ff2,start=c(week,1),frequency = 52)\n  \n  a = 52*i-51 \n  b = 52*i\n  rmse2[c(a:b),]  <-sqrt((ff2-xtest[,2:3])^2)\n}\n```\n\n```{r, message=FALSE,warning=FALSE}\nplot(1:52, rowMeans(rmse1,na.rm=TRUE), type=\"l\", col=2, xlab=\"Week\", ylab=\"RMSE\")\nlines(1:52, rowMeans(rmse2,na.rm=TRUE), type=\"l\",col=3)\nlegend(\"topleft\",legend=c(\"VAR 5\",\"VAR 1\"),col=2:4,lty=1)\n```\n\nVAR(5) appears to have lower RMSE than VAR(1), therefore VAR(5) is a better fit.\n\n:::\n\n\n## 4.4 Forecast\n\nIn this section, we used the model we selected from the results of cross validation to forecast the future trend.\n\n::: panel-tabset\n### (VAR)Daily Vaccination Number \\~ Independent Party Support Rate\n\nThe best model for this relationship is VAR(1).\n\n```{r, message=FALSE,warning=FALSE}\nvar1 <- VAR(inde_df.ts, p=1, type=\"const\")\nforecast(var1) %>%\n  autoplot() + xlab(\"Week\")+ theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA))\n```\n\nThe forecast results indicate a projected decline in daily vaccinations per million in the upcoming period, which aligns with our current understanding of the trends. Additionally, the support rate for the independent party is expected to decrease overall. These trends suggest significant shifts in public health dynamics and political landscapes, which warrant close monitoring and analysis to better understand the underlying factors driving these changes.\n\n### (VAR)Daily Vaccination Number \\~ Democratic Party Support Rate\n\nThe best model for this relationship is VAR(6).\n\n```{r, message=FALSE,warning=FALSE}\nvar1 <- VAR(demo_df.ts, p=6, type=\"const\")\nforecast(var1) %>%\n  autoplot() + xlab(\"Week\")+ theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA))\n```\n\nThe forecast results indicate a projected decline in daily vaccinations per million in the upcoming period, which aligns with our current understanding of the trends. Additionally, the support rate for the democratic party is expected to be stable with some fluctuations overall. These trends suggest significant shifts in public health dynamics and political landscapes, which warrant close monitoring and analysis to better understand the underlying factors driving these changes.\n\n### (VAR)Daily Vaccination Number \\~ Republican Party Support Rate\n\nThe best model for this relationship is VAR(5).\n\n```{r, message=FALSE,warning=FALSE}\nvar1 <- VAR(rep_df.ts, p=5, type=\"const\")\nforecast(var1) %>%\n  autoplot() + xlab(\"Week\")+ theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA))\n```\n\nThe forecast results indicate a projected decline in daily vaccinations per million in the upcoming period, which aligns with our current understanding of the trends. Additionally, the support rate for the republican party is expected to be stable with some fluctuations overall. These trends suggest significant shifts in public health dynamics and political landscapes, which warrant close monitoring and analysis to better understand the underlying factors driving these changes.\n\n:::\n\n\n\n\n\n\n\n\n\n\n","srcMarkdownNoYaml":"\n\n```{r,message=FALSE,warning=FALSE, echo=FALSE}\nlibrary(quantmod)\nlibrary(tidyquant)\nlibrary(ggplot2)\nlibrary(plotly)\nlibrary(ggfortify)\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(forecast)\nlibrary(astsa) \nlibrary(xts)\nlibrary(tseries)\nlibrary(fpp2)\nlibrary(lubridate)\nlibrary(gridExtra)\nlibrary(fpp2)          \nlibrary(zoo)   \nlibrary(readxl)\nlibrary(vars)\nlibrary(tseries)\nlibrary(gridExtra)\nlibrary(fma)\nlibrary(TSstudio)\n```\n\n# 1. Introduction\n\nIn this section, we delve into the application of ARIMAX, SARIMAX, and VAR modeling techniques across a range of time series datasets pertinent to our project's scope. ARIMAX and SARIMAX models come into play when we observe a unidirectional influence from one variable onto another. Conversely, VAR models are more suited to scenarios where a set of variables exhibits mutual influences.\n\nInitiating this phase of the project involved a comprehensive literature review to identify the models previously employed to analyze COVID vaccination-related variables. The study by Yundari (2022) leverages the Vector Autoregressive (VAR) model to simultaneously analyze the impact of vaccination numbers (first dose) on new and recovered COVID-19 cases, utilizing daily data from January 13 to December 30, 2021, in West Kalimantan Province. Ye (2021) underscores the critical nature of escalating COVID-19 Daily Vaccination Numbers to curtail the pandemic, noting that achieving vaccination targets remains an uphill task. This study probes into how political partisanship might influence Daily Vaccination Numbers, drawing comparisons between Democratic and Republican counties. Asch (2024) delves into the correlation between political leanings and the reporting of vaccine adverse events (AEs), revealing that a 10% uptick in Republican votes at the state level correlates with a 5% increase in the likelihood of reporting a COVID-19 vaccine AE.\n\n**References**\n\n1. Yundari, Y., & Huda, N. M. Analysis of the Impact of Vaccination on Daily New and Recovered COVID-19 Cases Using the Vector Autoregressive (VAR) Model: A Case Study of West Kalimantan. BAREKENG: Jurnal Ilmu Matematika dan Terapan. https://ojs3.unpatti.ac.id/index.php/barekeng/article/view/5266\n\n2. Ye, X. (2021). Exploring the Relationship Between Political Partisanship and COVID-19 Vaccination Rate. https://academic.oup.com/jpubhealth/article/45/1/91/6409075\n\n3. Asch, D.A., Luo, C., & Chen, Y. (2024). Reports of COVID-19 Vaccine Adverse Events in Predominantly Republican vs Democratic States. JAMA Network Open, 7(3), e244177. https://doi.org/10.1001/jamanetworkopen.2024.4177\n\n# 2. Define Models\n\nArmed with enhanced insights into the relevant variables, this section is dedicated to defining the specific ARIMAX/SARIMAX/VAR models to be utilized for analyzing changes in Daily Vaccination Numbers. Each model is tailored to examine different facets of the interplay between COVID-19 vaccination efforts and socio-economic as well as political dynamics.\n\n## 2.1 Confirmed COVID-19 Cases as a Function of Daily Vaccination Number:\n**(ARIMAX)Confirmed COVID-19 Cases \\~ Daily Vaccination Number**\n\nThis model aims to capture the impact of Daily Vaccination Numbers on the trend of newly confirmed COVID-19 cases.\n\n```{r, message=FALSE,warning=FALSE}\n# Read the dataset\nvac_df <- read_csv(\"Datasets/us_state_vaccinations.csv\")\n\n# Select relevant columns\ncols_show <- c('date', 'location', 'daily_vaccinations_per_million')\nt <- vac_df[, cols_show]\n\n# Group by 'date' and summarize columns, ignoring NA values\nt1 <- t %>%\n  group_by(date) %>%\n  summarize(\n    daily_vaccinations_per_million = sum(daily_vaccinations_per_million, na.rm = TRUE)\n  )\n\n# Convert date column to Date format\nt1$date <- as.Date(t1$date)\n\n# Newly confirmed cases\nwide_data <- read_csv(\"Datasets/covid_confirmed_usafacts.csv\")\n\n# Define the key and value columns for pivoting\nkey_cols <- c(\"countyFIPS\", \"County Name\", \"State\", \"StateFIPS\")\nvalue_cols <- setdiff(names(wide_data), key_cols)\n\n# Pivot the data from wide to long\nlong_data <- pivot_longer(\n  wide_data,\n  cols = value_cols,\n  names_to = \"date\",\n  values_to = \"value\"\n)\n\n# Group by 'State' and 'date', and calculate the sum of Confirmed Cases\ncon_case_df <- long_data %>%\n  group_by(date) %>%\n  summarize(value_sum = sum(value, na.rm = TRUE))\n\n# Convert date column to Date format\ncon_case_df$date <- as.Date(con_case_df$date)\n\n# Merge them together\ncava_df <- merge(t1, con_case_df, by = \"date\", all = FALSE)\nhead(cava_df)\n\n# Shape of the df\ncat('The shape of this dataframe is', dim(cava_df))\n```\n\n   \n## 2.2 COVID-19 Death Cases as a Function of Daily Vaccination Number: \n**(ARIMAX)COVID-19 Death Cases \\~ Daily Vaccination Number**\n\nThrough this model, we explore how variations in Daily Vaccination Numbers influence the count of COVID-19-related fatalities.\n\n```{r, message=FALSE,warning=FALSE}\n# Read the dataset\nvac_df <- read_csv(\"Datasets/us_state_vaccinations.csv\")\n\n# Select relevant columns\ncols_show <- c('date', 'location', 'daily_vaccinations_per_million')\nt <- vac_df[, cols_show]\n\n# Group by 'date' and summarize columns, ignoring NA values\nt1 <- t %>%\n  group_by(date) %>%\n  summarize(\n    daily_vaccinations_per_million = sum(daily_vaccinations_per_million, na.rm = TRUE)\n  )\n\n# Convert date column to Date format\nt1$date <- as.Date(t1$date)\n\n\n# Death cases\nwide_data <- read_csv(\"Datasets/covid_deaths_usafacts.csv\")\n\n# Define the key and value columns for pivoting\nkey_cols <- c(\"countyFIPS\", \"County Name\", \"State\", \"StateFIPS\")\nvalue_cols <- setdiff(names(wide_data), key_cols)\n\n# Pivot the data from wide to long\nlong_data <- pivot_longer(\n  wide_data,\n  cols = value_cols,\n  names_to = \"date\",\n  values_to = \"value\"\n)\n\n# Group by 'State' and 'date', and calculate the sum of Confirmed Cases\ndead_case_df <- long_data %>%\n  group_by(date) %>%\n  summarize(value_sum = sum(value, na.rm = TRUE))\n\n# Convert date column to Date format\ndead_case_df$date <- as.Date(dead_case_df$date)\n\n# Merge them together\ndeva_df <- merge(t1, dead_case_df, by = \"date\", all = FALSE)\nhead(deva_df)\n\n# Shape of the df\ncat('The shape of this dataframe is', dim(deva_df))\n```\n\n## 2.3 Unemployment Rate as Influenced by Daily Vaccination Number and Confirmed Cases:\n**(ARIMAX)Unemployment Rate \\~ Daily Vaccination Number + Confirmed COVID-19 Cases** \n\nThis model investigates the effect of Daily Vaccination Numbers and COVID-19 case counts on the unemployment rate, providing insights into the pandemic's broader economic implications.\n\n```{r, message=FALSE,warning=FALSE}\n# Read the dataset\nvac_df <- read_csv(\"Datasets/us_state_vaccinations.csv\")\n\n# Select relevant columns\ncols_show <- c('date', 'location', 'daily_vaccinations_per_million')\nt <- vac_df[, cols_show]\n\n# Group by 'date' and summarize columns, ignoring NA values\nt1 <- t %>%\n  group_by(date) %>%\n  summarize(\n    daily_vaccinations_per_million = sum(daily_vaccinations_per_million, na.rm = TRUE)\n  )\n\n# Convert date column to Date format\nt1$date <- as.Date(t1$date)\n\n# Aggregate data to monthly level using mean for each column\nt1 <- t1 %>%\n  group_by(date = format(date, \"%Y-%m\")) %>%\n  summarize(daily_vaccinations_per_million = mean(daily_vaccinations_per_million, na.rm = TRUE))\n\n# Transform the date column type with specified format\nt1$date <- as.Date(paste0(t1$date, \"-01-01\"))\n\n# Newly confirmed cases\nwide_data <- read_csv(\"Datasets/covid_confirmed_usafacts.csv\")\n\n# Define the key and value columns for pivoting\nkey_cols <- c(\"countyFIPS\", \"County Name\", \"State\", \"StateFIPS\")\nvalue_cols <- setdiff(names(wide_data), key_cols)\n\n# Pivot the data from wide to long\nlong_data <- pivot_longer(\n  wide_data,\n  cols = value_cols,\n  names_to = \"date\",\n  values_to = \"value\"\n)\n\n# Group by 'State' and 'date', and calculate the sum of Confirmed Cases\ncon_case_df <- long_data %>%\n  group_by(date) %>%\n  summarize(value_sum = sum(value, na.rm = TRUE))\n\n# Convert date column to Date format\ncon_case_df$date <- as.Date(con_case_df$date)\n\n# Aggregate data to monthly level using mean for each column\ncon_case_df <- con_case_df %>%\n  group_by(date = format(date, \"%Y-%m\")) %>%\n  summarize(value_sum = mean(value_sum, na.rm = TRUE))\n\n# Transform the date column type with specified format\ncon_case_df$date <- as.Date(paste0(con_case_df$date, \"-01-01\"))\n\n\nunemp <- read_csv('Datasets/unemployment.csv')\nkey_cols <- c(\"Location\")\nvalue_cols <- setdiff(names(unemp), key_cols)\nunemp1 <- pivot_longer(\n  unemp,\n  cols = value_cols,\n  names_to = \"Time\",\n  values_to = \"Unemployment\"\n)\n\n# Convert Time column to Date format\nunemp1$date <- as.Date(paste0(unemp1$Time, \"-01\"))\n\n# Convert Unemployment column to numeric (floating-point) format\nunemp1$Unemployment <- as.numeric(unemp1$Unemployment)\n\n# Focus on US\nunemp2 <- unemp1[unemp1$Location =='United States',]\nunemp3 <- unemp2[,c('date', 'Unemployment')]\n\n# Merge them together\ndd_df <- merge(t1, con_case_df, by = \"date\", all = FALSE)\nddd_df <- merge(dd_df, unemp3, by = \"date\", all = FALSE)\n\nhead(ddd_df)\n\n# Shape of the df\ncat('The shape of this dataframe is', dim(ddd_df))\n\n```\n\n## 2.4 Interdependence between Daily Vaccination Number and Independent Party Support Rate:\n**(VAR)Daily Vaccination Number \\~ Independent Party Support Rate** \n\nThis model evaluates how vaccination efforts and support for independent political parties influence each other over time.\n\n```{r, message=FALSE,warning=FALSE}\n# Read the dataset\nvac_df <- read_csv(\"Datasets/us_state_vaccinations.csv\")\n\n# Select relevant columns\ncols_show <- c('date', 'location', 'daily_vaccinations_per_million')\nt <- vac_df[, cols_show]\n\n# Group by 'date' and summarize columns, ignoring NA values\nt1 <- t %>%\n  group_by(date) %>%\n  summarize(\n    daily_vaccinations_per_million = sum(daily_vaccinations_per_million, na.rm = TRUE)\n  )\n\n# Convert date column to Date format\nt1$date <- as.Date(t1$date)\n\ndemo <- read_excel('Datasets/party.xlsx',sheet = 'Democrat')\ninde <- read_excel('Datasets/party.xlsx',sheet = 'Independent')\nrep <- read_excel('Datasets/party.xlsx',sheet = 'Republican')\n\n# Transform the wide dataframe into a long dataframe\nkey_cols <- c(\"Attitude\")\nvalue_cols <- setdiff(names(demo), key_cols)\ndemo1 <- pivot_longer(\n  demo,\n  cols = value_cols,\n  names_to = \"date\",\n  values_to = \"democrat\"\n)\n\ninde1 <- pivot_longer(\n  inde,\n  cols = value_cols,\n  names_to = \"date\",\n  values_to = \"independent\"\n)\n\nrep1 <- pivot_longer(\n  rep,\n  cols = value_cols,\n  names_to = \"date\",\n  values_to = \"republican\"\n)\n\n# Combine these three datasets together\ncombined_data <- full_join(demo1, inde1, by = c(\"date\", \"Attitude\")) %>%\n  full_join(rep1, by = c(\"date\", \"Attitude\"))\ncombined_data1 <- combined_data[combined_data$Attitude=='Favorable',]\n\n# Define the key and value columns for pivoting\nkey_cols <- c(\"Attitude\", \"date\")\nvalue_cols <- setdiff(names(combined_data1), key_cols)\n\n# Pivot the data from wide to long\ncombined_data2 <- pivot_longer(\n  combined_data1,\n  cols = value_cols,\n  names_to = \"Party\",\n  values_to = \"value\"\n)\n\n# Convert date column to Date format\ncombined_data2$date <- as.Date(combined_data2$date)\n\n# Subset to each party\ndemo_data <- combined_data2[combined_data2$Party=='democrat',][,c(\"date\",\"value\")]\ninde_data <- combined_data2[combined_data2$Party=='independent',][,c(\"date\",\"value\")]\nrep_data <- combined_data2[combined_data2$Party=='republican',][,c(\"date\",\"value\")]\n\ninde_df <- merge(t1, inde_data, by = \"date\", all = FALSE)\nhead(inde_df)\n\n# Shape of the df\ncat('The shape of this dataframe is', dim(inde_df))\n```\n\n## 2.5 Daily Vaccination Number and Democratic Party Support Rate Dynamics:\n**(VAR)Daily Vaccination Number \\~ Democratic Party Support Rate** \n\nHere, we assess the mutual influences between COVID-19 Daily Vaccination Numbers and support levels for the Democratic Party.\n\n```{r, message=FALSE,warning=FALSE}\ndemo_df <- merge(t1, demo_data, by = \"date\", all = FALSE)\nhead(demo_df)\n\n# Shape of the df\ncat('The shape of this dataframe is', dim(demo_df))\n```\n\n## 2.6 The Relationship between Daily Vaccination Number and Republican Party Support Rate:\n\n**(VAR)Daily Vaccination Number \\~ Republican Party Support Rate**\n\nThis model explores the bidirectional influence between vaccination initiatives and Republican Party support rates.\n\n```{r, message=FALSE,warning=FALSE}\nrep_df <- merge(t1, rep_data, by = \"date\", all = FALSE)\nhead(rep_df)\n\n# Shape of the df\ncat('The shape of this dataframe is', dim(rep_df))\n```\n\n# 3. ARIMAX/SARIMAX\n\n\n## 3.1 Variable Selection\n\nTo effectively construct an ARIMAX/SARIMAX model, it is crucial to select and define the response variable, which will serve as the primary focus of the analysis. Additionally, identifying relevant exogenous variables—those external predictor variables that are hypothesized to influence the response variable—is essential. This process involves a careful examination of potential predictors to ensure that they are not only relevant but also appropriately measured and free from collinearity issues. The selection of these variables should be guided by both theoretical considerations and empirical evidence, ensuring that they meaningfully contribute to the dynamics of the model. By integrating these exogenous variables, the ARIMAX/SARIMAX model can capture complex interactions and provide nuanced insights into how external factors may drive changes in the response variable over time.\n\n::: panel-tabset\n### (ARIMAX)Confirmed COVID-19 Cases \\~ Daily Vaccination Number\n```{r, message=FALSE,warning=FALSE}\ncava_df.ts<-ts(cava_df,star=decimal_date(as.Date(\"2020-12-20\",format = \"%Y-%m-%d\")),frequency = 365.25)\n\nautoplot(cava_df.ts[,c(2:3)], facets=TRUE, color=\"#5a3196\") +\n  xlab(\"Year\") + ylab(\"\") + theme_bw() +\n  ggtitle(\"Daily changes in new confirmed case and vaccination number\")\n\n```\n\n### (ARIMAX)COVID-19 Death Cases \\~ Daily Vaccination Number\n```{r, message=FALSE,warning=FALSE}\ndeva_df.ts<-ts(deva_df,star=decimal_date(as.Date(\"2020-12-20\",format = \"%Y-%m-%d\")),frequency = 365.25)\n\nautoplot(deva_df.ts[,c(2:3)], facets=TRUE, color=\"#5a3196\") +\n  xlab(\"Year\") + ylab(\"\") + theme_bw() +\n  ggtitle(\"Daily changes in dead case and new vaccination number\")\n\n```\n\n### (ARIMAX)Unemployment Rate \\~ Daily Vaccination Number + Confirmed COVID-19 Cases\n```{r, message=FALSE,warning=FALSE}\nddd_df.ts<-ts(ddd_df,star=decimal_date(as.Date(\"2020-12-01\",format = \"%Y-%m-%d\")),frequency = 12)\n\nautoplot(ddd_df.ts[,c(2:4)], facets=TRUE, color=\"#5a3196\") +\n  xlab(\"Year\") + ylab(\"\") + theme_bw() +\n  ggtitle(\"Monthly changes in new vaccination number, confirm case, and unemployment rate\")\n\n```\n:::\n\n## 3.2 Fit Auto.Arima()\n\n::: panel-tabset\n### (ARIMAX)Confirmed COVID-19 Cases \\~ Daily Vaccination Number\n```{r, message=FALSE,warning=FALSE}\nfit1 <- auto.arima(cava_df.ts[,\"value_sum\"],\n  xreg=cava_df.ts[,\"daily_vaccinations_per_million\"])\n\nsummary(fit1)\n\ncheckresiduals(fit1)\n\nmodel_output1 <- capture.output(sarima(residuals(fit1), 3,1,5)) \n\ncat(model_output1[76:91], model_output1[length(model_output1)], sep = \"\\n\")\n```\n\n- The **Standard Residual Plot** exhibits some inconsistencies in terms of mean and variance, suggesting potential issues with the model's assumptions about homoscedasticity or linearity.\n  \n- The **Autocorrelation Function (ACF)** plot reveals minimal correlation among residuals, suggesting that the model has effectively captured most of the underlying process; however, the presence of white noise indicates that the model may not be capturing all the data's nuances, which could point to an inadequate model fit.\n\n- The **Quantile-Quantile (Q-Q) Plot** shows that the residuals are mostly aligned with a normal distribution, suggesting that the normality assumption for the errors may largely hold, which is a positive indicator for the model’s reliability.\n\n- Results from the **Ljung-Box test** show p-values below the 0.05 significance level, which typically suggests a lack of fit as it indicates autocorrelation in the residuals at lag intervals that could influence the model's accuracy.\n\n- The coefficient table (**$ttable**) shows that the parameters ar1, ar2, ma4, and ma5 are statistically significant, highlighting their critical influence on the model's dynamics and underscoring the importance of these terms in explaining the time series variability.\n\n\n### (ARIMAX)COVID-19 Death Cases \\~ Daily Vaccination Number\n```{r, message=FALSE,warning=FALSE}\nfit2 <- auto.arima(deva_df.ts[,\"value_sum\"],\n  xreg=deva_df.ts[,\"daily_vaccinations_per_million\"])\n\nsummary(fit2)\n\ncheckresiduals(fit2)\n\nmodel_output2 <- capture.output(sarima(residuals(fit2), 5,2,2)) \n\ncat(model_output2[77:90], model_output2[length(model_output2)], sep = \"\\n\")\n\n```\n\n- The **Standard Residual Plot** suggests some irregularities in both the mean and the variance of the residuals, pointing to potential issues in the homoscedasticity or distribution assumptions of the model.\n\n- The **Autocorrelation Function (ACF) Plot** reveals minimal correlation among residuals, suggesting that most of the systematic information in the data has been captured by the model. However, the presence of any remaining correlation, albeit slight, could indicate that the model might not be capturing all underlying patterns effectively, which is indicative of a suboptimal fit.\n\n- The **Quantile-Quantile (Q-Q) Plot** shows that the residuals are approximately normally distributed, with only minor deviations from normality. This aspect of the diagnostics is generally positive, indicating that the assumption of normality is reasonably satisfied.\n\n- Results from the **Ljung-Box Test** show p-values below the 0.05 significance level, suggesting that there is still some autocorrelation present in the residuals at lagged intervals. This result contradicts the ideal scenario where p-values would significantly exceed the threshold, confirming the absence of autocorrelation and a good fit.\n\n- **Coefficient Significance Table**: All the coefficients in the model are statistically significant, suggesting that each predictor contributes meaningfully to the model. However, significance of coefficients alone does not necessarily imply an overall effective model fit, as it does not account for potential issues in other diagnostic areas.\n\n\n### (ARIMAX)Unemployment Rate \\~ Daily Vaccination Number + Confirmed COVID-19 Cases\n```{r, message=FALSE,warning=FALSE}\nfit3 <- auto.arima(ddd_df.ts[,\"Unemployment\"],\n  xreg=ddd_df.ts[,2:3])\n\nsummary(fit3)\n\ncheckresiduals(fit3)\n\nmodel_output3 <- capture.output(sarima(residuals(fit3), 0,0,0)) \n\ncat(model_output3[11:18], model_output3[length(model_output3)], sep = \"\\n\")\n\n```\n\n- The **Standard Residual Plot** reveals some inconsistencies in the mean and variance, suggesting potential deviations from homoscedasticity or the presence of outliers that could affect the robustness of the model predictions.\n  \n- The **Autocorrelation Function (ACF) Plot** exhibits minimal correlation among the residuals, which suggests that the model has effectively captured the underlying patterns in the data, leaving behind what appears to be white noise. This is a strong indicator of a well-fitting model.\n  \n- The **Quantile-Quantile (Q-Q) Plot** closely aligns with the theoretical normal distribution, underscoring the assumption of normality in the model's residuals, which is essential for the validity of many inferential statistics.\n  \n- The **Ljung-Box Test** results are mixed, with half of the p-values falling below the 0.05 significance threshold. This inconsistency suggests that some autocorrelations at different lags are significantly different from zero, indicating potential issues with the model fit.\n  \n- **Significance Table**: The statistical significance of all model coefficients is affirmed, implying that each predictor contributes meaningfully to the model. This significance is crucial for understanding the impact of each variable within the model and for making informed predictions or decisions based on the model’s outputs.\n\n:::\n\n\n## 3.3 Manually Fit\n\n::: panel-tabset\n### (ARIMAX)Confirmed COVID-19 Cases \\~ Daily Vaccination Number\n```{r, message=FALSE,warning=FALSE}\nfit.reg <- lm(value_sum ~ daily_vaccinations_per_million, data=cava_df.ts)\nsummary(fit.reg)\n```\n\nThe variables appear to be significant. Next, looking at the ACF/PACF plot of the residuals.\n\n```{r, message=FALSE,warning=FALSE}\nres.fit1<-ts(residuals(fit.reg),start = decimal_date(as.Date(\"2020-12-20\", format = \"%Y-%m-%d\")),frequency = 365.25)\n\nplot1<-ggAcf(res.fit1,20) + theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \nplot2<- ggPacf(res.fit1,20)+theme_bw()+ theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \n\ngrid.arrange(plot1, plot2,nrow=2)\n```\n\nThere appears to be seasonality still, so I will apply some differencing.\n\n```{r, message=FALSE,warning=FALSE}\nplot1<-ggAcf(diff(res.fit1),20) + theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \nplot2<- ggPacf(diff(res.fit1),20)+theme_bw()+ theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \n\ngrid.arrange(plot1, plot2,nrow=2)\n```\n\nAccording to the plots, we have the following values: p = 1,2,3 q= 1,2,3.\n\n```{r, message=FALSE,warning=FALSE}\nd=1\ni=1\ntemp= data.frame()\nls=matrix(rep(NA,6*32),nrow=32) \n\n\nfor (p in 0:3)\n{\n  for(q in 0:3)\n  {\n    for(d in 0:1)\n    {\n      \n      if(p-1+d+q-1<=8) #usual threshold\n      {\n        \n        model<- Arima(res.fit1/10000,order=c(p,d,q),include.drift=TRUE) \n        ls[i,]= c(p,d,q,model$aic,model$bic,model$aicc)\n        i=i+1\n        #print(i)\n        \n      }\n      \n    }\n  }\n}\n\n\ntemp= as.data.frame(ls)\nnames(temp)= c(\"p\",\"d\",\"q\",\"AIC\",\"BIC\",\"AICc\")\n\n#temp\nknitr::kable(temp)\n\ntemp[which.min(temp$AIC),] \n\ntemp[which.min(temp$BIC),]\n\ntemp[which.min(temp$AICc),]\n```\n\nThis gives me a Regression with model ARIMA(3,1,3).\n\n```{r}\nmodel_output1 <- capture.output(sarima(res.fit1, 3,1,3)) \n\ncat(model_output1[73:86], model_output1[length(model_output1)], sep = \"\\n\")\n```\n\n- The **Standard Residual Plot** exhibits some inconsistencies in terms of mean and variance, suggesting potential issues with the model's assumptions about homoscedasticity or linearity.\n  \n- The **Autocorrelation Function (ACF) Plot** exhibits minimal correlation among the residuals, which suggests that the model has effectively captured the underlying patterns in the data, leaving behind what appears to be white noise. This is a strong indicator of a well-fitting model.\n\n- The **Quantile-Quantile (Q-Q) Plot** shows that the residuals are mostly aligned with a normal distribution, suggesting that the normality assumption for the errors may largely hold, which is a positive indicator for the model’s reliability.\n\n- Results from the **Ljung-Box test** show p-values below the 0.05 significance level, which typically suggests a lack of fit as it indicates autocorrelation in the residuals at lag intervals that could influence the model's accuracy.\n\n- **Significance Table**: The statistical significance of all model coefficients is affirmed, implying that each predictor contributes meaningfully to the model. This significance is crucial for understanding the impact of each variable within the model and for making informed predictions or decisions based on the model’s outputs.\n\n\n### (ARIMAX)COVID-19 Death Cases \\~ Daily Vaccination Number\n```{r, message=FALSE,warning=FALSE}\nfit.reg <- lm(value_sum ~ daily_vaccinations_per_million, data=deva_df.ts)\nsummary(fit.reg)\n```\n\nThe variables appear to be significant. Next, looking at the ACF/PACF plot of the residuals.\n\n```{r, message=FALSE,warning=FALSE}\nres.fit1<-ts(residuals(fit.reg),start = decimal_date(as.Date(\"2020-12-20\", format = \"%Y-%m-%d\")),frequency = 365.25)\n\nplot1<-ggAcf(res.fit1,20) + theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \nplot2<- ggPacf(res.fit1,20)+theme_bw()+ theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \n\ngrid.arrange(plot1, plot2,nrow=2)\n```\n\nThere appears to be seasonality still, so I will apply some differencing.\n\n```{r, message=FALSE,warning=FALSE}\nplot1<-ggAcf(diff(res.fit1),20) + theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \nplot2<- ggPacf(diff(res.fit1),20)+theme_bw()+ theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \n\ngrid.arrange(plot1, plot2,nrow=2)\n```\n\nAccording to the plots, we have the following values: p = 1,2,3 q= 1,2,3.\n\n```{r, message=FALSE,warning=FALSE}\nd=1\ni=1\ntemp= data.frame()\nls=matrix(rep(NA,6*32),nrow=32) \n\n\nfor (p in 0:3)\n{\n  for(q in 0:3)\n  {\n    for(d in 0:1)\n    {\n      \n      if(p-1+d+q-1<=8) #usual threshold\n      {\n        \n        model<- Arima(res.fit1/10000,order=c(p,d,q),include.drift=TRUE) \n        ls[i,]= c(p,d,q,model$aic,model$bic,model$aicc)\n        i=i+1\n        #print(i)\n        \n      }\n      \n    }\n  }\n}\n\n\ntemp= as.data.frame(ls)\nnames(temp)= c(\"p\",\"d\",\"q\",\"AIC\",\"BIC\",\"AICc\")\n\n#temp\nknitr::kable(temp)\n\ntemp[which.min(temp$AIC),] \n\ntemp[which.min(temp$BIC),]\n\ntemp[which.min(temp$AICc),]\n```\n\nThis gives me a Regression with model ARIMA(3,1,3).\n\n```{r}\nmodel_output1 <- capture.output(sarima(res.fit1, 3,1,3)) \n\ncat(model_output1[77:90], model_output1[length(model_output1)], sep = \"\\n\")\n```\n\n- The **Standard Residual Plot** exhibits some inconsistencies in terms of mean and variance, suggesting potential issues with the model's assumptions about homoscedasticity or linearity.\n  \n- The **Autocorrelation Function (ACF) Plot** exhibits minimal correlation among the residuals, which suggests that the model has effectively captured the underlying patterns in the data, leaving behind what appears to be white noise. This is a strong indicator of a well-fitting model.\n\n- The **Quantile-Quantile (Q-Q) Plot** shows that the residuals are mostly aligned with a normal distribution, suggesting that the normality assumption for the errors may largely hold, which is a positive indicator for the model’s reliability.\n\n- Results from the **Ljung-Box test** show p-values below the 0.05 significance level, which typically suggests a lack of fit as it indicates autocorrelation in the residuals at lag intervals that could influence the model's accuracy.\n\n- **Significance Table**: The statistical significance of all model coefficients is affirmed, implying that each predictor contributes meaningfully to the model. This significance is crucial for understanding the impact of each variable within the model and for making informed predictions or decisions based on the model’s outputs.\n\n\n### (ARIMAX)Unemployment Rate \\~ Daily Vaccination Number + Confirmed COVID-19 Cases\n```{r, message=FALSE,warning=FALSE}\nfit.reg <- lm(Unemployment ~ daily_vaccinations_per_million + value_sum, data=ddd_df.ts)\nsummary(fit.reg)\n```\n\nThe confirmed COVID-19 case number appears to be significant. Next, looking at the ACF/PACF plot of the residuals.\n\n```{r, message=FALSE,warning=FALSE}\nres.fit1<-ts(residuals(fit.reg),start = decimal_date(as.Date(\"2020-12-01\", format = \"%Y-%m-%d\")),frequency = 12)\n\nplot1<-ggAcf(res.fit1) + theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \nplot2<- ggPacf(res.fit1)+theme_bw()+ theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \n\ngrid.arrange(plot1, plot2,nrow=2)\n```\n\nAccording to the plots, we have the following values: p = 1 q= 1.\n\n```{r, message=FALSE,warning=FALSE}\nd=1\ni=1\ntemp= data.frame()\nls=matrix(rep(NA,6*8),nrow=8) \n\n\nfor (p in 0:1)\n{\n  for(q in 0:1)\n  {\n    for(d in 0:1)\n    {\n      \n      if(p-1+d+q-1<=8) #usual threshold\n      {\n        \n        model<- Arima(res.fit1/10000,order=c(p,d,q),include.drift=TRUE) \n        ls[i,]= c(p,d,q,model$aic,model$bic,model$aicc)\n        i=i+1\n        #print(i)\n        \n      }\n      \n    }\n  }\n}\n\n\ntemp= as.data.frame(ls)\nnames(temp)= c(\"p\",\"d\",\"q\",\"AIC\",\"BIC\",\"AICc\")\n\n#temp\nknitr::kable(temp)\n\ntemp[which.min(temp$AIC),] \n\ntemp[which.min(temp$BIC),]\n\ntemp[which.min(temp$AICc),]\n```\n\nThis gives me a Regression with model ARIMA(1,0,0).\n\n```{r}\nmodel_output1 <- capture.output(sarima(res.fit1, 1,0,0)) \n\ncat(model_output1[21:29], model_output1[length(model_output1)], sep = \"\\n\")\n```\n\n- The **Standard Residual Plot** exhibits some inconsistencies in terms of mean and variance, suggesting potential issues with the model's assumptions about homoscedasticity or linearity.\n  \n- The **Autocorrelation Function (ACF) Plot** exhibits minimal correlation among the residuals, which suggests that the model has effectively captured the underlying patterns in the data, leaving behind what appears to be white noise. This is a strong indicator of a well-fitting model.\n\n- The **Quantile-Quantile (Q-Q) Plot** shows that the residuals are mostly aligned with a normal distribution, suggesting that the normality assumption for the errors may largely hold, which is a positive indicator for the model’s reliability.\n\n- Results from the **Ljung-Box test** show p-values above the 0.05 significance level, which typically suggests a good fit as it indicates autocorrelation in the residuals at lag intervals.\n\n- **Significance Table**: The statistical significance of all model coefficients is affirmed, implying that each predictor contributes meaningfully to the model. This significance is crucial for understanding the impact of each variable within the model and for making informed predictions or decisions based on the model’s outputs.\n\n:::\n\n## 3.4 Cross Validation\n\nTo confirm our selection on the model, we choose to use cross validation to compare the RMSE values to help us make decision.\n\n::: panel-tabset\n### (ARIMAX)Confirmed COVID-19 Cases \\~ Daily Vaccination Number\n\nAuto.arima gave me ARIMA(3,1,5), while the manual model selection resulted in ARIMA(3,1,3).\n\n```{r, message=FALSE,warning=FALSE}\nfit.reg <- lm(value_sum ~ daily_vaccinations_per_million, data=cava_df.ts)\nres.fit1<-ts(residuals(fit.reg),start = decimal_date(as.Date(\"2020-12-20\", format = \"%Y-%m-%d\")),frequency = 365.25)\n\nn = length(res.fit1) # 872\nk = 220\n\ni=1\nerr1 = c()\nerr2 = c()\n\nfor(i in 1:(n-k))\n{\n  xtrain <- res.fit1[1:(k-1)+i] #observations from 1 to 12\n  xtest <- res.fit1[k+i] #13th observation as the test set\n  \n  fit1 <- Arima(xtrain, order=c(3,1,5),include.drift=FALSE, method=\"ML\")\n  fcast1 <- forecast(fit1, h=1)\n  \n  fit2 <- Arima(xtrain, order=c(3,1,3),include.drift=FALSE, method=\"ML\")\n  fcast2 <- forecast(fit2, h=1)\n\n  \n  #capture error for each iteration\n  # This is mean absolute error\n  err1 = c(err1, abs(fcast1$mean-xtest)) \n  err2 = c(err2, abs(fcast2$mean-xtest))\n  \n  # This is mean squared error\n  err3 = c(err1, (fcast1$mean-xtest)^2)\n  err4 = c(err2, (fcast2$mean-xtest)^2)\n  #print(i)\n}\n\nRMSE1 <- sqrt(mean(err3, na.rm = TRUE))\nRMSE2 <- sqrt(mean(err4, na.rm = TRUE))\n\ncat('The RMSE of Auto Arima is', RMSE1, '\\n')\ncat('The RMSE of Manually Selection is', RMSE2, '\\n')\n```\n\nThe Auto Arima model had lower RMSE compared to the manual model. Therefore, the best model is ARIMA(3,1,5).\n\n### (ARIMAX)COVID-19 Death Cases \\~ Daily Vaccination Number\n\nAuto.arima gave me ARIMA(5,2,2), while the manual model selection resulted in ARIMA(3,1,3).\n\n```{r, message=FALSE,warning=FALSE}\nfit.reg <- lm(value_sum ~ daily_vaccinations_per_million, data=deva_df.ts)\nres.fit1<-ts(residuals(fit.reg),start = decimal_date(as.Date(\"2020-12-20\", format = \"%Y-%m-%d\")),frequency = 365.25)\n\nn = length(res.fit1) # 872\nk = 220\n\ni=1\nerr1 = c()\nerr2 = c()\n\nfor(i in 1:(n-k))\n{\n  xtrain <- res.fit1[1:(k-1)+i] #observations from 1 to 12\n  xtest <- res.fit1[k+i] #13th observation as the test set\n  \n  fit1 <- Arima(xtrain, order=c(5,2,2),include.drift=FALSE, method=\"ML\")\n  fcast1 <- forecast(fit1, h=1)\n  \n  fit2 <- Arima(xtrain, order=c(3,1,3),include.drift=FALSE, method=\"ML\")\n  fcast2 <- forecast(fit2, h=1)\n\n  \n  #capture error for each iteration\n  # This is mean absolute error\n  err1 = c(err1, abs(fcast1$mean-xtest)) \n  err2 = c(err2, abs(fcast2$mean-xtest))\n  \n  # This is mean squared error\n  err3 = c(err1, (fcast1$mean-xtest)^2)\n  err4 = c(err2, (fcast2$mean-xtest)^2)\n  #print(i)\n}\n\nRMSE1 <- sqrt(mean(err3, na.rm = TRUE))\nRMSE2 <- sqrt(mean(err4, na.rm = TRUE))\n\ncat('The RMSE of Auto Arima is', RMSE1, '\\n')\ncat('The RMSE of Manually Selection is', RMSE2, '\\n')\n```\n\nThe manual model had lower RMSE compared to the Auto Arima model. Therefore, the best model is ARIMA(3,1,3).\n\n### (ARIMAX)Unemployment Rate \\~ Daily Vaccination Number + Confirmed COVID-19 Cases\n\nAuto.arima gave me ARIMA(0,0,0), while the manual model selection resulted in ARIMA(1,0,0). Since the data sample for this time series only contains 16 observations, we choose to use ARIMA(1,0,0) since ARIMA(0,0,0) contains more biases\n\n:::\n\n\n## 3.5 Model Fitting\n\nIn this section, we will use the best model to fit the model.\n\n::: panel-tabset\n### (ARIMAX)Confirmed COVID-19 Cases \\~ Daily Vaccination Number\n\nThe best ARIMAX model for this relationship is ARIMA(3,1,5).\n\n```{r, message=FALSE,warning=FALSE}\nfit1 <- Arima(cava_df.ts[,\"value_sum\"],order=c(3,1,5), xreg=cava_df.ts[,\"daily_vaccinations_per_million\"])\nsummary(fit1)\n```\n\n**Equation:**\n\n$$ \\nabla Y_t = \\mu - 0.0956 \\nabla Y_{t-1} + 0.533 \\nabla Y_{t-2} + 0.5298 \\nabla Y_{t-3} + 0.2741 \\epsilon_{t-1} - 0.6293 \\epsilon_{t-2} - 0.6067 \\epsilon_{t-3} + 0.3318 \\epsilon_{t-4} + 0.5648 \\epsilon_{t-5} - 0.0029 X_t + \\epsilon_t  $$\n\n\n\n### (ARIMAX)COVID-19 Death Cases \\~ Daily Vaccination Number\n\nThe best ARIMAX model for this relationship is ARIMA(3,1,3).\n\n```{r, message=FALSE,warning=FALSE}\nfit1 <- Arima(deva_df.ts[,\"value_sum\"],order=c(3,1,3), xreg=deva_df.ts[,\"daily_vaccinations_per_million\"])\nsummary(fit1)\n```\n\n**Equation:**\n\n$$ \\nabla Y_t = \\mu + 0.5142 \\nabla Y_{t-1} - 0.4725 \\nabla Y_{t-2} + 0.9553 \\nabla Y_{t-3} - 0.3085 \\epsilon_{t-1} + 0.4341 \\epsilon_{t-2} - 0.8067 \\epsilon_{t-3} + 0.0018 X_t + \\epsilon_t  $$\n\n### (ARIMAX)Unemployment Rate \\~ Daily Vaccination Number + Confirmed COVID-19 Cases\n\nThe best ARIMAX model for this relationship is ARIMA(1,0,0).\n\n```{r, message=FALSE,warning=FALSE}\nfit1 <- Arima(ddd_df.ts[,\"Unemployment\"],order=c(1,0,0), xreg=ddd_df.ts[,2:3])\nsummary(fit1)\n```\n\n**Equation:**\n\n$$ \\nabla Y_t = 0.066 + 0.897 \\nabla Y_{t-1} + \\epsilon_t  $$\n\n:::\n\n## 3.6 Forecast\n\nThen, I use the best model for each relationship and forecast the values. \n\n::: panel-tabset\n### (ARIMAX)Confirmed COVID-19 Cases \\~ Daily Vaccination Number\n\n```{r, message=FALSE,warning=FALSE}\nfit1 <- Arima(cava_df.ts[,\"value_sum\"],order=c(3,1,5), xreg=cava_df.ts[,\"daily_vaccinations_per_million\"])\nforecast(fit1, h = 100, xreg=cava_df.ts[,\"daily_vaccinations_per_million\"]) %>%\n  autoplot() + xlab(\"Date\")+ theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \n```\n\nIn summary, this forecast suggests that, according to the ARIMA(3,1,5) model used, the daily confirmed cases are expected to remain at a consistent level in the near term, with the uncertainty of the forecast increasing as it projects further out into the future.\n\n### (ARIMAX)COVID-19 Death Cases \\~ Daily Vaccination Number\n\n```{r, message=FALSE,warning=FALSE}\nfit1 <- Arima(deva_df.ts[,\"value_sum\"],order=c(3,1,3), xreg=deva_df.ts[,\"daily_vaccinations_per_million\"])\nforecast(fit1, h = 100, xreg=deva_df.ts[,\"daily_vaccinations_per_million\"]) %>%\n  autoplot() + xlab(\"Date\")+ theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \n```\n\nIn summary, this forecast suggests that, according to the ARIMA(3,1,3) model used, the daily dead cases are expected to remain at a consistent level in the near term, with the uncertainty of the forecast increasing as it projects further out into the future.\n\n### (ARIMAX)Unemployment Rate \\~ Daily Vaccination Number + Confirmed COVID-19 Cases\n\n```{r, message=FALSE,warning=FALSE}\nfit1 <- Arima(ddd_df.ts[,\"Unemployment\"],order=c(1,0,0), xreg=ddd_df.ts[,2:3])\nforecast(fit1, h = 4, xreg=ddd_df.ts[,2:3]) %>%\n  autoplot() + xlab(\"Month\")+ theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA)) \n```\n\nIn summary, the model seems to predict that the decreasing trend in unemployment observed in the actual data will not persist in the same way, and that unemployment may stabilize at the levels seen at the end of the observed data.\n\n:::\n\n\n# 4. VAR\n\n## 4.1 Variable Selection\n\nWhen crafting a VAR model, it is pivotal to delineate each variable that will be considered within the system. Unlike ARIMAX/SARIMAX models, which focus on a primary response variable influenced by exogenous predictors, VAR models treat all included variables as endogenously interrelated. Each variable in a VAR model is explained by its own lagged values as well as the lagged values of all other variables in the system, allowing for a multidirectional analysis of influence and response over time.\n\nThe selection process for variables in a VAR model is underpinned by both theoretical frameworks and empirical data, necessitating a rigorous review to ascertain their interconnectedness and the absence of unit roots that may indicate non-stationarity. This ensures that each variable not only possesses inherent relevance but also contributes to a comprehensive understanding of the system's internal dynamics. By employing a VAR model, one can dissect and comprehend the nuanced interplay between variables, enabling a holistic view of how each variable evolves in relation to others within the dataset.\n\n::: panel-tabset\n### (VAR)Daily Vaccination Number \\~ Independent Party Support Rate\n\n```{r, message=FALSE,warning=FALSE}\ninde_df.ts<-ts(inde_df,star=decimal_date(as.Date(\"2020-12-22\",format = \"%Y-%m-%d\")),frequency = 52)\n\nautoplot(inde_df.ts[,c(2:3)], facets=TRUE, color=\"#5a3196\") +\n  xlab(\"Year\") + ylab(\"\") + theme_bw() +\n  ggtitle(\"Daily changes in new vaccination number and independent party support rate\")\n```\n\n### (VAR)Daily Vaccination Number \\~ Democratic Party Support Rate\n\n```{r, message=FALSE,warning=FALSE}\ndemo_df.ts<-ts(demo_df,star=decimal_date(as.Date(\"2020-12-22\",format = \"%Y-%m-%d\")),frequency = 52)\n\nautoplot(demo_df.ts[,c(2:3)], facets=TRUE, color=\"#5a3196\") +\n  xlab(\"Year\") + ylab(\"\") + theme_bw() +\n  ggtitle(\"Daily changes in new vaccination number and democratic party support rate\")\n\n```\n\n### (VAR)Daily Vaccination Number \\~ Republican Party Support Rate\n\n```{r, message=FALSE,warning=FALSE}\nrep_df.ts<-ts(rep_df,star=decimal_date(as.Date(\"2020-12-22\",format = \"%Y-%m-%d\")),frequency = 52)\n\nautoplot(rep_df.ts[,c(2:3)], facets=TRUE, color=\"#5a3196\") +\n  xlab(\"Year\") + ylab(\"\") + theme_bw() +\n  ggtitle(\"Daily changes in new vaccination number and republican party support rate\")\n```\n:::\n\n## 4.2 Variable Selection\n\nIn the process of refining our VAR model, a critical step involves selecting the optimal number of lag periods, denoted as \\( p \\). This selection is pivotal as it significantly influences the model's accuracy and effectiveness in capturing the dynamics between the time series variables. To determine the best \\( p \\), we utilize criteria such as the Akaike Information Criterion (AIC), the Bayesian Information Criterion (BIC), and the Hannan-Quinn Information Criterion (HQIC), which help in balancing model complexity and goodness of fit.\n\n::: panel-tabset\n### (VAR)Daily Vaccination Number \\~ Independent Party Support Rate\n\n```{r, message=FALSE,warning=FALSE}\nVARselect(inde_df.ts, lag.max=10, type=\"both\")\n```\n\nAccording to the selection criterion, we select the model with p=1 and 3.\n\n```{r, message=FALSE,warning=FALSE}\nsummary(vars::VAR(inde_df.ts, p=1, type='both'))\n```\n\n```{r, message=FALSE,warning=FALSE}\nsummary(vars::VAR(inde_df.ts, p=3, type='both'))\n```\n\nExamining the VAR models with \\( p = 1 \\) and \\( p = 3 \\) lag orders, we notice the presence of some variables that do not significantly contribute to the model. Notably, the model with \\( p = 3 \\) lag periods tends to have fewer significant variables compared to the \\( p = 1 \\) model. However, opting for \\( p = 1 \\) may overly simplify the model, potentially failing to capture all the relevant and significant relationships among the variables. Thus, while \\( p = 1 \\) offers a more parsimonious model, it might not sufficiently account for the complexity of the dynamics within the data, suggesting that a balance must be struck between model simplicity and its ability to elucidate significant interactions.\n\n### (VAR)Daily Vaccination Number \\~ Democratic Party Support Rate\n\n```{r, message=FALSE,warning=FALSE}\nVARselect(demo_df.ts, lag.max=10, type=\"both\")\n```\n\nAccording to the selection criterion, we select the model with p=1 and 6.\n\n```{r, message=FALSE,warning=FALSE}\nsummary(vars::VAR(demo_df.ts, p=1, type='both'))\n```\n\n```{r, message=FALSE,warning=FALSE}\nsummary(vars::VAR(demo_df.ts, p=6, type='both'))\n```\n\nFrom the perspective of the p-values associated with these models, each demonstrates a moderate number of significant variables. Although a model with \\( p = 1 \\) lag might appear overly simplistic and possibly inadequate for capturing the full dynamics of the dataset, a model with \\( p = 6 \\) lags could potentially offer a slight improvement. This enhancement in performance suggests that incorporating more lag terms allows the VAR model to better account for the temporal dependencies among the variables, thus providing a more accurate and insightful analysis.\n\n### (VAR)Daily Vaccination Number \\~ Republican Party Support Rate\n\n```{r, message=FALSE,warning=FALSE}\nVARselect(rep_df.ts, lag.max=10, type=\"both\")\n```\n\nAccording to the selection criterion, we select the model with p=1 and 5(second lowest AIC).\n\n```{r, message=FALSE,warning=FALSE}\nsummary(vars::VAR(rep_df.ts, p=1, type='both'))\n```\n\n```{r, message=FALSE,warning=FALSE}\nsummary(vars::VAR(rep_df.ts, p=5, type='both'))\n```\n\nExamining the VAR models with \\( p = 1 \\) and \\( p = 5 \\) lag orders, we notice the presence of some variables that do not significantly contribute to the model. Notably, the model with \\( p = 5 \\) lag periods tends to have fewer significant variables compared to the \\( p = 1 \\) model. However, opting for \\( p = 1 \\) may overly simplify the model, potentially failing to capture all the relevant and significant relationships among the variables. Thus, while \\( p = 1 \\) offers a more parsimonious model, it might not sufficiently account for the complexity of the dynamics within the data, suggesting that a balance must be struck between model simplicity and its ability to elucidate significant interactions.\n\n:::\n\n\n## 4.3 Cross Validation\n\nTo validate our hypothesis and ensure the robustness of our model selection, we employ cross-validation to compare the Root Mean Squared Error (RMSE) of the two chosen models. By assessing the RMSE, we can quantitatively determine which model provides a more accurate fit to the data.\n\n::: panel-tabset\n### (VAR)Daily Vaccination Number \\~ Independent Party Support Rate\n\n```{r, message=FALSE,warning=FALSE}\n#n=length(inde_df.ts) 351\n#n-k=91; 260/52=5;\nn=length(inde_df.ts)\nk=91\n\nrmse1 <- matrix(NA, 52,5)\nrmse2 <- matrix(NA, 52,5)\nweek<-c()\n\n# Convert data frame to time series object\nst <- tsp(inde_df.ts )[1]+(k-1)/52\n\n\nfor(i in 1:1)\n{\n  \n  xtrain <- window(inde_df.ts, end=st + i-1)\n  xtest <- window(inde_df.ts, start=st + (i-1) + 1/52, end=st + i)\n  \n  ######## first Model ############\n  fit <- VAR(inde_df.ts, p=3, type='both')\n  fcast <- predict(fit, n.ahead = 52)\n  \n  fvacc<-fcast$fcst$daily_vaccinations_per_million\n  fsupp<-fcast$fcst$value\n\n  ff<-data.frame(fvacc[,1],fsupp[,1]) #collecting the forecasts for 3 variables\n  \n  week<-st + (i-1) + 1/52 \n  \n  ff<-ts(ff,start=c(week,1),frequency = 52)\n  \n  a = 52*i-51 \n  b = 52*i \n  \n  ##### collecting errors ######\n  rmse1[c(a:b),]  <-sqrt((ff-xtest[,2:3])^2)\n  \n  ######## Second Model ############\n  fit2 <- vars::VAR(inde_df.ts, p=1, type='both')\n  fcast2 <- predict(fit2, n.ahead = 52)\n  \n  fvacc<-fcast2$fcst$daily_vaccinations_per_million\n  fsupp<-fcast2$fcst$value\n\n  ff2<-data.frame(fvacc[,1],fsupp[,1])\n  \n  week<-st + (i-1) + 1/52\n  \n  ff2<-ts(ff2,start=c(week,1),frequency = 52)\n  \n  a = 52*i-51 \n  b = 52*i\n  rmse2[c(a:b),]  <-sqrt((ff2-xtest[,2:3])^2)\n}\n```\n\n```{r, message=FALSE,warning=FALSE}\nplot(1:52, rowMeans(rmse1,na.rm=TRUE), type=\"l\", col=2, xlab=\"Week\", ylab=\"RMSE\")\nlines(1:52, rowMeans(rmse2,na.rm=TRUE), type=\"l\",col=3)\nlegend(\"topleft\",legend=c(\"VAR 3\",\"VAR 1\"),col=2:4,lty=1)\n```\n\nVAR(1) appears to have lower RMSE than VAR(3), therefore VAR(1) is a better fit.\n\n### (VAR)Daily Vaccination Number \\~ Democratic Party Support Rate\n\n```{r, message=FALSE,warning=FALSE}\n#n=length(inde_df.ts) 351\n#n-k=91; 260/52=5;\nn=length(demo_df.ts)\nk=91\n\nrmse1 <- matrix(NA, 52,5)\nrmse2 <- matrix(NA, 52,5)\nweek<-c()\n\n# Convert data frame to time series object\nst <- tsp(demo_df.ts )[1]+(k-1)/52\n\n\nfor(i in 1:1)\n{\n  \n  xtrain <- window(demo_df.ts, end=st + i-1)\n  xtest <- window(demo_df.ts, start=st + (i-1) + 1/52, end=st + i)\n  \n  ######## first Model ############\n  fit <- VAR(demo_df.ts, p=6, type='both')\n  fcast <- predict(fit, n.ahead = 52)\n  \n  fvacc<-fcast$fcst$daily_vaccinations_per_million\n  fsupp<-fcast$fcst$value\n\n  ff<-data.frame(fvacc[,1],fsupp[,1]) #collecting the forecasts for 3 variables\n  \n  week<-st + (i-1) + 1/52 \n  \n  ff<-ts(ff,start=c(week,1),frequency = 52)\n  \n  a = 52*i-51 \n  b = 52*i \n  \n  ##### collecting errors ######\n  rmse1[c(a:b),]  <-sqrt((ff-xtest[,2:3])^2)\n  \n  ######## Second Model ############\n  fit2 <- vars::VAR(demo_df.ts, p=1, type='both')\n  fcast2 <- predict(fit2, n.ahead = 52)\n  \n  fvacc<-fcast2$fcst$daily_vaccinations_per_million\n  fsupp<-fcast2$fcst$value\n\n  ff2<-data.frame(fvacc[,1],fsupp[,1])\n  \n  week<-st + (i-1) + 1/52\n  \n  ff2<-ts(ff2,start=c(week,1),frequency = 52)\n  \n  a = 52*i-51 \n  b = 52*i\n  rmse2[c(a:b),]  <-sqrt((ff2-xtest[,2:3])^2)\n}\n```\n\n```{r, message=FALSE,warning=FALSE}\nplot(1:52, rowMeans(rmse1,na.rm=TRUE), type=\"l\", col=2, xlab=\"Week\", ylab=\"RMSE\")\nlines(1:52, rowMeans(rmse2,na.rm=TRUE), type=\"l\",col=3)\nlegend(\"topleft\",legend=c(\"VAR 6\",\"VAR 1\"),col=2:4,lty=1)\n```\n\nVAR(6) appears to have lower RMSE than VAR(1), therefore VAR(6) is a better fit.\n\n### (VAR)Daily Vaccination Number \\~ Republican Party Support Rate\n\n```{r, message=FALSE,warning=FALSE}\n#n=length(inde_df.ts) 351\n#n-k=91; 260/52=5;\nn=length(rep_df.ts)\nk=91\n\nrmse1 <- matrix(NA, 52,5)\nrmse2 <- matrix(NA, 52,5)\nweek<-c()\n\n# Convert data frame to time series object\nst <- tsp(rep_df.ts )[1]+(k-1)/52\n\n\nfor(i in 1:1)\n{\n  \n  xtrain <- window(rep_df.ts, end=st + i-1)\n  xtest <- window(rep_df.ts, start=st + (i-1) + 1/52, end=st + i)\n  \n  ######## first Model ############\n  fit <- VAR(rep_df.ts, p=5, type='both')\n  fcast <- predict(fit, n.ahead = 52)\n  \n  fvacc<-fcast$fcst$daily_vaccinations_per_million\n  fsupp<-fcast$fcst$value\n\n  ff<-data.frame(fvacc[,1],fsupp[,1]) #collecting the forecasts for 3 variables\n  \n  week<-st + (i-1) + 1/52 \n  \n  ff<-ts(ff,start=c(week,1),frequency = 52)\n  \n  a = 52*i-51 \n  b = 52*i \n  \n  ##### collecting errors ######\n  rmse1[c(a:b),]  <-sqrt((ff-xtest[,2:3])^2)\n  \n  ######## Second Model ############\n  fit2 <- vars::VAR(rep_df.ts, p=1, type='both')\n  fcast2 <- predict(fit2, n.ahead = 52)\n  \n  fvacc<-fcast2$fcst$daily_vaccinations_per_million\n  fsupp<-fcast2$fcst$value\n\n  ff2<-data.frame(fvacc[,1],fsupp[,1])\n  \n  week<-st + (i-1) + 1/52\n  \n  ff2<-ts(ff2,start=c(week,1),frequency = 52)\n  \n  a = 52*i-51 \n  b = 52*i\n  rmse2[c(a:b),]  <-sqrt((ff2-xtest[,2:3])^2)\n}\n```\n\n```{r, message=FALSE,warning=FALSE}\nplot(1:52, rowMeans(rmse1,na.rm=TRUE), type=\"l\", col=2, xlab=\"Week\", ylab=\"RMSE\")\nlines(1:52, rowMeans(rmse2,na.rm=TRUE), type=\"l\",col=3)\nlegend(\"topleft\",legend=c(\"VAR 5\",\"VAR 1\"),col=2:4,lty=1)\n```\n\nVAR(5) appears to have lower RMSE than VAR(1), therefore VAR(5) is a better fit.\n\n:::\n\n\n## 4.4 Forecast\n\nIn this section, we used the model we selected from the results of cross validation to forecast the future trend.\n\n::: panel-tabset\n### (VAR)Daily Vaccination Number \\~ Independent Party Support Rate\n\nThe best model for this relationship is VAR(1).\n\n```{r, message=FALSE,warning=FALSE}\nvar1 <- VAR(inde_df.ts, p=1, type=\"const\")\nforecast(var1) %>%\n  autoplot() + xlab(\"Week\")+ theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA))\n```\n\nThe forecast results indicate a projected decline in daily vaccinations per million in the upcoming period, which aligns with our current understanding of the trends. Additionally, the support rate for the independent party is expected to decrease overall. These trends suggest significant shifts in public health dynamics and political landscapes, which warrant close monitoring and analysis to better understand the underlying factors driving these changes.\n\n### (VAR)Daily Vaccination Number \\~ Democratic Party Support Rate\n\nThe best model for this relationship is VAR(6).\n\n```{r, message=FALSE,warning=FALSE}\nvar1 <- VAR(demo_df.ts, p=6, type=\"const\")\nforecast(var1) %>%\n  autoplot() + xlab(\"Week\")+ theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA))\n```\n\nThe forecast results indicate a projected decline in daily vaccinations per million in the upcoming period, which aligns with our current understanding of the trends. Additionally, the support rate for the democratic party is expected to be stable with some fluctuations overall. These trends suggest significant shifts in public health dynamics and political landscapes, which warrant close monitoring and analysis to better understand the underlying factors driving these changes.\n\n### (VAR)Daily Vaccination Number \\~ Republican Party Support Rate\n\nThe best model for this relationship is VAR(5).\n\n```{r, message=FALSE,warning=FALSE}\nvar1 <- VAR(rep_df.ts, p=5, type=\"const\")\nforecast(var1) %>%\n  autoplot() + xlab(\"Week\")+ theme_bw()+\n      theme(plot.background = element_rect(fill = \"#D9E3F1\", color = NA),\n            panel.background = element_rect(fill = \"#D9E3F1\", color = NA))\n```\n\nThe forecast results indicate a projected decline in daily vaccinations per million in the upcoming period, which aligns with our current understanding of the trends. Additionally, the support rate for the republican party is expected to be stable with some fluctuations overall. These trends suggest significant shifts in public health dynamics and political landscapes, which warrant close monitoring and analysis to better understand the underlying factors driving these changes.\n\n:::\n\n\n\n\n\n\n\n\n\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"embed-resources":true,"output-file":"MT.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","theme":"lumen","title":"Multivariate TS Models"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}